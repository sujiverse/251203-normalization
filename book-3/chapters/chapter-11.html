<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11장: Metabase 시작하기 - 물리치료사를 위한 데이터베이스 3권</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    @@include('components/top-nav.html', {"root": "../..", "activeBook": "3"})

    @@include('components/mobile-menu.html')
    <div class="container">
        <nav class="sidebar" id="sidebar">
            <button class="close-btn" onclick="toggleMenu()">×</button>
            <div class="sidebar-header">
                <h1>📙 물리치료사를 위한</h1>
                <p>실전 구축 & 대시보드 (3권)</p>
            </div>
            <ul class="nav-list" id="navList"></ul>
        </nav>
        <main class="main">
<h1 class="title">Metabase 시작하기</h1>

<h2>SQL 없이도 데이터를 볼 수 있다면?</h2>

<p>지금까지 모든 데이터 조회는 SQL로 했습니다. SELECT 문을 작성하고, 실행하고, 결과를 텍스트로 확인했죠. 물론 이것도 좋지만, 매번 쿼리를 직접 작성하는 건 번거롭습니다.</p>

<p>김지훈 원장이 매일 아침 "오늘 예약 현황"을 보려면 SQL을 실행해야 할까요? "이번 달 매출"을 확인하려면? 매번 그러기엔 너무 불편합니다.</p>

<p>그래서 <strong>Metabase</strong>를 사용합니다. Metabase는 데이터를 예쁜 차트와 대시보드로 보여주는 도구입니다. SQL을 몰라도 클릭만으로 데이터를 조회할 수 있고, SQL을 알면 더 강력하게 활용할 수 있어요.</p>

<h3>Metabase로 할 수 있는 것</h3>

<ul>
<li>클릭만으로 데이터 조회 (SQL 없이)</li>
<li>차트, 그래프로 시각화</li>
<li>여러 차트를 모은 대시보드 생성</li>
<li>자동 새로고침으로 실시간 현황 파악</li>
<li>팀원들과 공유</li>
</ul>

<hr>

<h2>1. Metabase 접속 확인</h2>

<p>2권에서 Docker로 Metabase를 설치했습니다. 먼저 잘 실행되고 있는지 확인해봅시다.</p>

<h3>Docker 컨테이너 확인</h3>

<pre><code># 터미널에서 실행
docker ps</code></pre>

<p>결과에 <code>metabase/metabase</code>가 보이고 STATUS가 "Up"이면 실행 중입니다.</p>

<pre><code>CONTAINER ID   IMAGE               STATUS          PORTS
a1b2c3d4e5f6   metabase/metabase   Up 2 hours      0.0.0.0:3000->3000/tcp</code></pre>

<p>실행 중이 아니면 시작합니다:</p>

<pre><code>docker start metabase</code></pre>

<h3>브라우저에서 접속</h3>

<p>웹 브라우저를 열고 주소창에 입력:</p>

<pre><code>http://localhost:3000</code></pre>

<p>Metabase 로그인 화면이 나오면 성공입니다! 2권에서 설정한 이메일과 비밀번호로 로그인하세요.</p>

<div class="warning"><strong>⚠️ 접속이 안 된다면?</strong><br>
<ol>
<li>Docker Desktop이 실행 중인지 확인</li>
<li><code>docker start metabase</code> 실행</li>
<li>1~2분 기다린 후 다시 접속</li>
</ol>
</div>

<hr>

<h2>2. 데이터베이스 연결 확인</h2>

<p>2권에서 MySQL 연결을 설정해두었습니다. 제대로 연결되었는지 확인해봅시다.</p>

<h3>연결 상태 확인</h3>

<ol>
<li>오른쪽 상단 <strong>톱니바퀴(⚙️)</strong> 클릭</li>
<li><strong>관리자</strong> 클릭</li>
<li>왼쪽 메뉴에서 <strong>데이터베이스</strong> 클릭</li>
<li>"힐링손 DB" (또는 설정한 이름) 확인</li>
</ol>

<p>상태가 초록색이면 연결 성공입니다!</p>

<h3>연결이 안 되어 있다면</h3>

<p>"데이터베이스 추가" 버튼을 클릭하고 다음 정보를 입력:</p>

<table>
<tr><th>항목</th><th>값</th></tr>
<tr><td>데이터베이스 유형</td><td>MySQL</td></tr>
<tr><td>표시 이름</td><td>힐링손 DB</td></tr>
<tr><td>호스트</td><td>host.docker.internal</td></tr>
<tr><td>포트</td><td>3306</td></tr>
<tr><td>데이터베이스 이름</td><td>healing_hands</td></tr>
<tr><td>사용자 이름</td><td>root</td></tr>
<tr><td>비밀번호</td><td>(MySQL 비밀번호)</td></tr>
</table>

<p>"저장" 클릭 후 연결이 성공하면 테이블 목록이 자동으로 동기화됩니다.</p>

<hr>

<h2>3. Metabase 화면 구성</h2>

<p>Metabase의 주요 화면을 알아봅시다.</p>

<h3>홈 화면</h3>

<p>로그인하면 나오는 첫 화면입니다. 최근에 본 항목, 저장한 질문, 대시보드 등이 표시됩니다.</p>

<h3>상단 메뉴</h3>

<table>
<tr><th>메뉴</th><th>기능</th></tr>
<tr><td>🏠 홈</td><td>홈 화면으로 이동</td></tr>
<tr><td>🔍 검색</td><td>질문, 대시보드 검색</td></tr>
<tr><td>➕ 새로 만들기</td><td>질문, 대시보드, 컬렉션 생성</td></tr>
<tr><td>⚙️ 설정</td><td>관리자 설정</td></tr>
</table>

<h3>주요 개념</h3>

<table>
<tr><th>용어</th><th>설명</th></tr>
<tr><td>질문 (Question)</td><td>하나의 데이터 조회. SQL의 SELECT와 비슷</td></tr>
<tr><td>대시보드 (Dashboard)</td><td>여러 질문을 모아놓은 화면</td></tr>
<tr><td>컬렉션 (Collection)</td><td>질문/대시보드를 정리하는 폴더</td></tr>
<tr><td>필터 (Filter)</td><td>데이터 조건 (WHERE와 비슷)</td></tr>
</table>

<hr>

<h2>4. 첫 번째 질문 만들기</h2>

<p>Metabase에서 데이터를 조회하는 것을 "질문"이라고 부릅니다. 첫 번째 질문을 만들어봅시다.</p>

<h3>단순 질문: 환자 목록 보기</h3>

<ol>
<li>상단의 <strong>➕ 새로 만들기</strong> 클릭</li>
<li><strong>질문</strong> 선택</li>
<li><strong>단순 질문</strong> 선택</li>
<li>데이터베이스: <strong>힐링손 DB</strong> 선택</li>
<li>테이블: <strong>patients</strong> 선택</li>
</ol>

<p>짜잔! 환자 목록이 테이블로 표시됩니다. SQL 한 줄도 안 썼는데요!</p>

<h3>필터 추가: 남성 환자만</h3>

<ol>
<li>오른쪽 상단 <strong>필터</strong> 버튼 클릭</li>
<li><strong>gender</strong> 선택</li>
<li><strong>M</strong> 입력 후 적용</li>
</ol>

<p>이제 남성 환자만 표시됩니다. SQL로 하면 <code>WHERE gender = 'M'</code>과 같아요.</p>

<h3>질문 저장하기</h3>

<ol>
<li>오른쪽 상단 <strong>저장</strong> 버튼 클릭</li>
<li>이름 입력: "환자 목록"</li>
<li>컬렉션 선택 (또는 새로 만들기): "힐링손"</li>
<li><strong>저장</strong> 클릭</li>
</ol>

<p>이제 언제든 "환자 목록"을 클릭하면 이 화면을 볼 수 있습니다!</p>

<hr>

<h2>5. 집계 질문 만들기</h2>

<p>단순 목록보다 유용한 건 집계입니다. "몇 명인지", "합계가 얼마인지" 같은 것들이요.</p>

<h3>성별 환자 수</h3>

<ol>
<li><strong>➕ 새로 만들기</strong> → <strong>질문</strong> → <strong>단순 질문</strong></li>
<li>테이블: <strong>patients</strong></li>
<li>오른쪽 <strong>요약</strong> 버튼 클릭</li>
<li>"다음 기준으로 그룹화": <strong>gender</strong> 선택</li>
<li>"계산": <strong>행 수</strong> (기본값)</li>
</ol>

<p>결과:</p>
<pre><code>gender | count
-------+-------
F      | 15
M      | 15</code></pre>

<p>SQL로 하면:</p>
<pre><code>SELECT gender, COUNT(*) FROM patients GROUP BY gender;</code></pre>

<h3>시각화 변경: 막대 그래프</h3>

<ol>
<li>결과 아래 <strong>시각화</strong> 버튼 클릭</li>
<li><strong>막대형</strong> 선택</li>
</ol>

<p>테이블이 막대 그래프로 바뀝니다! 📊</p>

<hr>

<h2>6. SQL로 질문 만들기</h2>

<p>복잡한 질문은 SQL로 직접 작성할 수도 있습니다. Metabase에서 SQL을 실행하고 결과를 시각화할 수 있어요.</p>

<h3>네이티브 쿼리 (SQL) 질문</h3>

<ol>
<li><strong>➕ 새로 만들기</strong> → <strong>SQL 쿼리</strong></li>
<li>데이터베이스: <strong>힐링손 DB</strong> 선택</li>
<li>SQL 입력창에 쿼리 작성</li>
</ol>

<h3>예시: 치료사별 이번 달 매출</h3>

<pre><code>SELECT
t.name as 치료사,
COUNT(*) as 치료건수,
SUM(b.total_amount) as 매출
FROM treatment_sessions ts
JOIN therapists t ON ts.therapist_id = t.therapist_id
JOIN billings b ON ts.session_id = b.session_id
WHERE ts.session_date BETWEEN '2024-03-01' AND '2024-03-31'
AND b.payment_status = '완료'
GROUP BY t.therapist_id, t.name
ORDER BY 매출 DESC;</code></pre>

<ol>
<li>쿼리 입력 후 <strong>실행</strong> 버튼 클릭 (또는 Ctrl+Enter)</li>
<li>결과 확인</li>
<li>시각화 → <strong>막대형</strong> 선택</li>
<li>저장: "치료사별 월 매출"</li>
</ol>

<h3>변수 사용하기 (동적 필터)</h3>

<p>매번 날짜를 수정하기 귀찮죠? 변수를 사용하면 됩니다.</p>

<pre><code>SELECT
t.name as 치료사,
COUNT(*) as 치료건수,
SUM(b.total_amount) as 매출
FROM treatment_sessions ts
JOIN therapists t ON ts.therapist_id = t.therapist_id
JOIN billings b ON ts.session_id = b.session_id
WHERE ts.session_date BETWEEN {{시작일}} AND {{종료일}}
AND b.payment_status = '완료'
GROUP BY t.therapist_id, t.name
ORDER BY 매출 DESC;</code></pre>

<p><code>{{시작일}}</code>과 <code>{{종료일}}</code>이 필터로 바뀝니다. 실행하면 날짜 선택 창이 나타나요!</p>

<div class="tip"><strong>💡 변수 문법</strong><br>
<ul>
<li><code>{{변수명}}</code> - 기본 필터 (텍스트 입력)</li>
<li><code>{{변수명:날짜}}</code> - 날짜 선택기</li>
<li><code>[[AND 조건 = {{변수명}}]]</code> - 선택적 필터 (입력 안 하면 무시)</li>
</ul>
</div>

<hr>

<h2>7. 컬렉션 정리</h2>

<p>질문이 많아지면 정리가 필요합니다. 컬렉션(폴더)을 만들어서 분류하세요.</p>

<h3>컬렉션 만들기</h3>

<ol>
<li><strong>➕ 새로 만들기</strong> → <strong>컬렉션</strong></li>
<li>이름 입력: "힐링손 물리치료센터"</li>
<li>저장</li>
</ol>

<h3>하위 컬렉션 만들기</h3>

<p>컬렉션 안에 컬렉션을 만들 수 있습니다.</p>

<ul>
<li>힐링손 물리치료센터
<ul>
<li>📊 매출 분석</li>
<li>👥 환자 관리</li>
<li>👨‍⚕️ 치료사 실적</li>
<li>📋 운영 현황</li>
</ul>
</li>
</ul>

<hr>

<h2>✅ 체크포인트</h2>

<p>이번 장을 마치기 전에 확인하세요:</p>

<table>
<tr><th>항목</th><th>확인</th></tr>
<tr><td>Metabase 접속 가능</td><td>☐</td></tr>
<tr><td>힐링손 DB 연결됨</td><td>☐</td></tr>
<tr><td>단순 질문 만들기 성공</td><td>☐</td></tr>
<tr><td>집계 질문 만들기 성공</td><td>☐</td></tr>
<tr><td>SQL 질문 만들기 성공</td><td>☐</td></tr>
<tr><td>컬렉션 생성 완료</td><td>☐</td></tr>
</table>

<hr>

<h2>이번 장 요약</h2>

<p>이번 장에서 배운 것:</p>

<ol>
<li>Metabase <strong>접속 및 연결</strong> 확인</li>
<li><strong>단순 질문</strong>으로 테이블 조회</li>
<li><strong>집계 질문</strong>으로 그룹화, 합계</li>
<li><strong>시각화</strong> 변경 (테이블 → 차트)</li>
<li><strong>SQL 질문</strong>으로 복잡한 조회</li>
<li><strong>변수</strong>로 동적 필터</li>
<li><strong>컬렉션</strong>으로 정리</li>
</ol>

<p>이제 Metabase의 기본을 익혔습니다! 다음 장부터는 본격적으로 대시보드를 만듭니다. 첫 번째로 "매출 대시보드"를 만들어볼 거예요.</p>

            <div class="nav-buttons">
                <button class="nav-btn" id="prevBtn">← 이전</button>
                <span class="page-num" id="pageNum"></span>
                <button class="nav-btn" id="nextBtn">다음 →</button>
            </div>
        </main>
    </div>
    <script src="../js/nav.js"></script>
</body>
</html>
