<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9ì¥: ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬ - ë¬¼ë¦¬ì¹˜ë£Œì‚¬ë¥¼ ìœ„í•œ ë°ì´í„°ë² ì´ìŠ¤ 3ê¶Œ</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    @@include('components/top-nav.html', {"root": "../..", "activeBook": "3"})

    @@include('components/mobile-menu.html')
    <div class="container">
        <nav class="sidebar" id="sidebar">
            <button class="close-btn" onclick="toggleMenu()">Ã—</button>
            <div class="sidebar-header">
                <h1>ğŸ“™ ë¬¼ë¦¬ì¹˜ë£Œì‚¬ë¥¼ ìœ„í•œ</h1>
                <p>ì‹¤ì „ êµ¬ì¶• & ëŒ€ì‹œë³´ë“œ (3ê¶Œ)</p>
            </div>
            <ul class="nav-list" id="navList"></ul>
        </nav>
        <main class="main">
<h1 class="title">ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬</h1>

<h2>í˜„ì‹¤ì—ì„œ ë°œìƒí•˜ëŠ” íŠ¹ìˆ˜ ì¼€ì´ìŠ¤</h2>

<p>ë°ì´í„°ë² ì´ìŠ¤ê°€ ì™„ë²½í•˜ê²Œ ì„¤ê³„ë˜ì–´ë„, í˜„ì‹¤ì˜ ì—…ë¬´ëŠ” í•­ìƒ ì˜ˆì™¸ ìƒí™©ì´ ë°œìƒí•©ë‹ˆë‹¤. í™˜ìê°€ ì˜ˆì•½ì„ ì·¨ì†Œí•˜ê³ , í™˜ë¶ˆì„ ìš”ì²­í•˜ê³ , ë°ì´í„°ë¥¼ ì˜ëª» ì…ë ¥í•˜ê³ ... ì´ëŸ° ìƒí™©ë“¤ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ ì•Œì•„ë´…ì‹œë‹¤.</p>

<h3>ì´ë²ˆ ì¥ì—ì„œ ë‹¤ë£° ì˜ˆì™¸ ìƒí™©</h3>

<ul>
<li>ì˜ˆì•½ ì·¨ì†Œ/ë…¸ì‡¼ ì²˜ë¦¬</li>
<li>í™˜ë¶ˆ ì²˜ë¦¬</li>
<li>ë°ì´í„° ìˆ˜ì •/ì‚­ì œ</li>
<li>í™˜ì ë¹„í™œì„±í™”</li>
<li>ë³µí•© ê²°ì œ ì²˜ë¦¬</li>
</ul>

<hr>

<h2>1. ì˜ˆì•½ ì·¨ì†Œ/ë…¸ì‡¼ ì²˜ë¦¬</h2>

<h3>ì˜ˆì•½ ì·¨ì†Œ</h3>

<pre><code>-- ì˜ˆì•½ ìƒíƒœë¥¼ 'ì·¨ì†Œ'ë¡œ ë³€ê²½
UPDATE treatment_sessions
SET session_status = 'ì·¨ì†Œ',
    notes = CONCAT(IFNULL(notes, ''), ' [ì·¨ì†Œ: í™˜ì ìš”ì²­]')
WHERE session_id = 100;

-- í•´ë‹¹ ì²­êµ¬ë„ ì·¨ì†Œ ì²˜ë¦¬
UPDATE billings
SET payment_status = 'ì·¨ì†Œ',
    memo = 'ì˜ˆì•½ ì·¨ì†Œë¡œ ì¸í•œ ì²­êµ¬ ì·¨ì†Œ'
WHERE session_id = 100;</code></pre>

<h3>ë…¸ì‡¼(No-Show) ì²˜ë¦¬</h3>

<pre><code>-- ì—°ë½ ì—†ì´ ë¯¸ë°©ë¬¸í•œ ê²½ìš°
UPDATE treatment_sessions
SET session_status = 'ë…¸ì‡¼',
    notes = CONCAT(IFNULL(notes, ''), ' [ë…¸ì‡¼: ì—°ë½ ì•ˆ ë¨]')
WHERE session_id = 101;

-- ë…¸ì‡¼ ì´ë ¥ ì¡°íšŒ (ìƒìŠµ ë…¸ì‡¼ í™˜ì í™•ì¸)
SELECT
    p.name as í™˜ìëª…,
    p.phone as ì—°ë½ì²˜,
    COUNT(*) as ë…¸ì‡¼íšŸìˆ˜,
    MAX(ts.session_date) as ìµœê·¼ë…¸ì‡¼
FROM treatment_sessions ts
JOIN patients p ON ts.patient_id = p.patient_id
WHERE ts.session_status = 'ë…¸ì‡¼'
GROUP BY p.patient_id, p.name, p.phone
HAVING COUNT(*) >= 2
ORDER BY ë…¸ì‡¼íšŸìˆ˜ DESC;</code></pre>

<hr>

<h2>2. í™˜ë¶ˆ ì²˜ë¦¬</h2>

<h3>ì „ì•¡ í™˜ë¶ˆ</h3>

<pre><code>-- ì²­êµ¬ ìƒíƒœë¥¼ 'í™˜ë¶ˆ'ë¡œ ë³€ê²½
UPDATE billings
SET payment_status = 'í™˜ë¶ˆ',
    memo = CONCAT(IFNULL(memo, ''), ' [í™˜ë¶ˆ: 2024-03-25 ì „ì•¡]')
WHERE billing_id = 50;

-- ë˜ëŠ” ë³„ë„ í™˜ë¶ˆ ê¸°ë¡ ì¶”ê°€ (ë§ˆì´ë„ˆìŠ¤ ê¸ˆì•¡)
INSERT INTO billings (
    session_id, fee_code, quantity, unit_price,
    total_amount, payment_status, payment_method, payment_date, memo
) VALUES (
    50, 'FEE001', 1, 80000,
    -80000, 'ì™„ë£Œ', 'ì¹´ë“œì·¨ì†Œ', '2024-03-25', 'í™˜ë¶ˆ: í™˜ì ìš”ì²­'
);</code></pre>

<h3>ë¶€ë¶„ í™˜ë¶ˆ</h3>

<pre><code>-- 80,000ì› ì¤‘ 30,000ì›ë§Œ í™˜ë¶ˆ
INSERT INTO billings (
    session_id, fee_code, quantity, unit_price,
    total_amount, payment_status, payment_method, payment_date, memo
) VALUES (
    50, 'FEE001', 1, 30000,
    -30000, 'ì™„ë£Œ', 'í˜„ê¸ˆ', '2024-03-25', 'ë¶€ë¶„í™˜ë¶ˆ: ì¹˜ë£Œ ì¤‘ë‹¨'
);</code></pre>

<hr>

<h2>3. ë°ì´í„° ìˆ˜ì •</h2>

<h3>í™˜ì ì •ë³´ ìˆ˜ì •</h3>

<pre><code>-- ì—°ë½ì²˜ ë³€ê²½
UPDATE patients
SET phone = '010-9876-5432',
    updated_at = CURRENT_TIMESTAMP
WHERE patient_id = 'P001';

-- ë³´í—˜ ì •ë³´ ë³€ê²½
UPDATE patients
SET insurance_code = 'INS002',
    memo = CONCAT(IFNULL(memo, ''), ' [ë³´í—˜ë³€ê²½: 2024-03-25]'),
    updated_at = CURRENT_TIMESTAMP
WHERE patient_id = 'P001';</code></pre>

<h3>ì¹˜ë£Œ ê¸°ë¡ ìˆ˜ì •</h3>

<pre><code>-- ì¹˜ë£Œì‚¬ ë³€ê²½ (ë‹´ë‹¹ ë³€ê²½)
UPDATE treatment_sessions
SET therapist_id = 'T002',
    notes = CONCAT(IFNULL(notes, ''), ' [ë‹´ë‹¹ë³€ê²½: T001â†’T002]'),
    updated_at = CURRENT_TIMESTAMP
WHERE session_id = 88;

-- ì¹˜ë£Œ ë‚ ì§œ ìˆ˜ì • (ì˜¤ì…ë ¥ ì •ì •)
UPDATE treatment_sessions
SET session_date = '2024-03-24',
    notes = CONCAT(IFNULL(notes, ''), ' [ë‚ ì§œì •ì •: 3/25â†’3/24]'),
    updated_at = CURRENT_TIMESTAMP
WHERE session_id = 88;</code></pre>

<h3>ì²­êµ¬ ê¸ˆì•¡ ìˆ˜ì •</h3>

<pre><code>-- í• ì¸ ì ìš©
UPDATE billings
SET unit_price = 70000,
    total_amount = 70000,
    memo = '10% í• ì¸ ì ìš©',
    updated_at = CURRENT_TIMESTAMP
WHERE billing_id = 85;

-- ì¹˜ë£Œ í•­ëª© ë³€ê²½
UPDATE billings
SET fee_code = 'FEE002',
    unit_price = 150000,
    total_amount = 150000,
    memo = '60ë¶„ ì¹˜ë£Œë¡œ ë³€ê²½',
    updated_at = CURRENT_TIMESTAMP
WHERE billing_id = 85;</code></pre>

<hr>

<h2>4. ë°ì´í„° ì‚­ì œ</h2>

<div class="danger"><strong>ğŸš¨ ì£¼ì˜!</strong><br>
ì‚­ì œëŠ” ë³µêµ¬ê°€ ì–´ë µìŠµë‹ˆë‹¤. ê°€ëŠ¥í•˜ë©´ 'ìƒíƒœ ë³€ê²½'ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³ , ì •ë§ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‚­ì œí•˜ì„¸ìš”. ì‚­ì œ ì „ ë°˜ë“œì‹œ ë°±ì—…í•˜ì„¸ìš”!</div>

<h3>í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œ</h3>

<pre><code>-- ì‚­ì œ ì „ í™•ì¸!
SELECT * FROM treatment_sessions WHERE session_id = 999;

-- ì™¸ë˜í‚¤ ê´€ê³„ ë•Œë¬¸ì— ìˆœì„œê°€ ì¤‘ìš”
-- 1. ìì‹ í…Œì´ë¸”ë¶€í„° ì‚­ì œ
DELETE FROM billings WHERE session_id = 999;
DELETE FROM soap_notes WHERE session_id = 999;

-- 2. ë¶€ëª¨ í…Œì´ë¸” ì‚­ì œ
DELETE FROM treatment_sessions WHERE session_id = 999;</code></pre>

<h3>í™˜ì ë°ì´í„° ì‚­ì œ (ë¹„ì¶”ì²œ)</h3>

<pre><code>-- í™˜ì ì‚­ì œëŠ” ê¶Œì¥í•˜ì§€ ì•ŠìŒ!
-- ëŒ€ì‹  ë¹„í™œì„±í™” ì²˜ë¦¬ë¥¼ ê¶Œì¥

-- ì •ë§ ì‚­ì œí•´ì•¼ í•œë‹¤ë©´:
-- 1. ê´€ë ¨ ë°ì´í„° ëª¨ë‘ ì‚­ì œ í•„ìš”
DELETE FROM soap_notes WHERE session_id IN
    (SELECT session_id FROM treatment_sessions WHERE patient_id = 'P999');
DELETE FROM billings WHERE session_id IN
    (SELECT session_id FROM treatment_sessions WHERE patient_id = 'P999');
DELETE FROM treatment_sessions WHERE patient_id = 'P999';
DELETE FROM patient_diagnoses WHERE patient_id = 'P999';
DELETE FROM patients WHERE patient_id = 'P999';</code></pre>

<hr>

<h2>5. í™˜ì ë¹„í™œì„±í™”</h2>

<p>í™˜ìê°€ ë” ì´ìƒ ë°©ë¬¸í•˜ì§€ ì•Šê±°ë‚˜, ë°ì´í„° ì‚­ì œ ìš”ì²­ì´ ìˆì„ ë•ŒëŠ” ì‚­ì œ ëŒ€ì‹  ë¹„í™œì„±í™”ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.</p>

<pre><code>-- í™˜ì ë¹„í™œì„±í™”
UPDATE patients
SET is_active = 'N',
    memo = CONCAT(IFNULL(memo, ''), ' [ë¹„í™œì„±í™”: 2024-03-25 ì´ì „ìš”ì²­]'),
    updated_at = CURRENT_TIMESTAMP
WHERE patient_id = 'P010';

-- ë¹„í™œì„±í™”ëœ í™˜ìëŠ” ì¼ë°˜ ì¡°íšŒì—ì„œ ì œì™¸
SELECT * FROM patients WHERE is_active = 'Y';

-- ë¹„í™œì„±í™”ëœ í™˜ì ëª©ë¡
SELECT patient_id, name, phone, memo
FROM patients
WHERE is_active = 'N';</code></pre>

<hr>

<h2>6. ë³µí•© ê²°ì œ ì²˜ë¦¬</h2>

<h3>ì¹´ë“œ + í˜„ê¸ˆ ë¶„í•  ê²°ì œ</h3>

<pre><code>-- 80,000ì›ì„ ì¹´ë“œ 50,000 + í˜„ê¸ˆ 30,000ìœ¼ë¡œ ê²°ì œ
-- ë°©ë²• 1: ì²­êµ¬ë¥¼ 2ê±´ìœ¼ë¡œ ë¶„ë¦¬
INSERT INTO billings (session_id, fee_code, quantity, unit_price, total_amount, payment_status, payment_method, payment_date, memo) VALUES
(88, 'FEE001', 1, 50000, 50000, 'ì™„ë£Œ', 'ì¹´ë“œ', '2024-03-25', 'ë¶„í• ê²°ì œ 1/2'),
(88, 'FEE001', 1, 30000, 30000, 'ì™„ë£Œ', 'í˜„ê¸ˆ', '2024-03-25', 'ë¶„í• ê²°ì œ 2/2');

-- ë°©ë²• 2: ë©”ëª¨ì— ê¸°ë¡ (ë‹¨ìˆœí™”)
INSERT INTO billings (session_id, fee_code, quantity, unit_price, total_amount, payment_status, payment_method, payment_date, memo) VALUES
(88, 'FEE001', 1, 80000, 80000, 'ì™„ë£Œ', 'ë³µí•©', '2024-03-25', 'ì¹´ë“œ50000+í˜„ê¸ˆ30000');</code></pre>

<h3>í¬ì¸íŠ¸/ì¿ í° ì‚¬ìš©</h3>

<pre><code>-- ì¿ í°ìœ¼ë¡œ 10,000ì› í• ì¸
INSERT INTO billings (session_id, fee_code, quantity, unit_price, total_amount, payment_status, payment_method, payment_date, memo) VALUES
(88, 'FEE001', 1, 80000, 70000, 'ì™„ë£Œ', 'ì¹´ë“œ', '2024-03-25', 'ì‹ ê·œí™˜ì ì¿ í° -10000ì›');</code></pre>

<hr>

<h2>7. ì§„ë‹¨ ë³€ê²½</h2>

<h3>ì£¼ì§„ë‹¨ ë³€ê²½</h3>

<pre><code>-- ê¸°ì¡´ ì£¼ì§„ë‹¨ì„ ë¶€ì§„ë‹¨ìœ¼ë¡œ
UPDATE patient_diagnoses
SET is_primary = 'N'
WHERE patient_id = 'P001' AND is_primary = 'Y';

-- ìƒˆ ì§„ë‹¨ì„ ì£¼ì§„ë‹¨ìœ¼ë¡œ ì¶”ê°€
INSERT INTO patient_diagnoses (patient_id, diagnosis_code, diagnosis_date, is_primary, notes)
VALUES ('P001', 'M51.1', '2024-03-25', 'Y', 'ì£¼ì§„ë‹¨ ë³€ê²½: ìš”í†µâ†’ë””ìŠ¤í¬');</code></pre>

<h3>ì§„ë‹¨ ì¶”ê°€</h3>

<pre><code>-- ë¶€ì§„ë‹¨ ì¶”ê°€
INSERT INTO patient_diagnoses (patient_id, diagnosis_code, diagnosis_date, is_primary, notes)
VALUES ('P001', 'M79.1', '2024-03-25', 'N', 'ê·¼ë§‰í†µì¦ ì¶”ê°€');</code></pre>

<hr>

<h2>8. ìë™ì°¨ë³´í—˜ í™˜ì ì²˜ë¦¬</h2>

<h3>ìë³´ í™˜ì ë“±ë¡</h3>

<pre><code>-- ìë™ì°¨ë³´í—˜ í™˜ì ë“±ë¡
INSERT INTO patients (patient_id, name, gender, birth_date, phone, insurance_code, memo) VALUES
('P050', 'í™ê¸¸ë™', 'M', '1985-05-05', '010-5555-5555', 'INS004', 'ìë™ì°¨ë³´í—˜ í™˜ì, ì‚¬ê³ ì¼: 2024-03-20');

-- ìë³´ ì¹˜ë£Œ ê¸°ë¡
INSERT INTO treatment_sessions (patient_id, therapist_id, session_date, start_time, end_time, session_status, notes) VALUES
('P050', 'T001', '2024-03-25', '11:00', '11:40', 'ì™„ë£Œ', 'ìë³´ì¹˜ë£Œ');

-- ìë³´ ì²­êµ¬ (ë³´í—˜ì‚¬ ì²­êµ¬)
INSERT INTO billings (session_id, fee_code, quantity, unit_price, total_amount, payment_status, payment_method, memo) VALUES
(LAST_INSERT_ID(), 'FEE007', 1, 100000, 100000, 'ëŒ€ê¸°', NULL, 'ìë™ì°¨ë³´í—˜ ì²­êµ¬ ì˜ˆì •');</code></pre>

<h3>ìë³´ ìˆ˜ë‚© ì™„ë£Œ ì²˜ë¦¬</h3>

<pre><code>-- ë³´í—˜ì‚¬ì—ì„œ ì…ê¸ˆ í™•ì¸ í›„
UPDATE billings
SET payment_status = 'ì™„ë£Œ',
    payment_method = 'ê³„ì¢Œì´ì²´',
    payment_date = '2024-04-15',
    memo = 'ìë™ì°¨ë³´í—˜ ì…ê¸ˆì™„ë£Œ'
WHERE billing_id = 100;</code></pre>

<hr>

<h2>ì˜ˆì™¸ ì²˜ë¦¬ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>

<table>
<tr><th>ìƒí™©</th><th>ì²˜ë¦¬ ë°©ë²•</th></tr>
<tr><td>ì˜ˆì•½ ì·¨ì†Œ</td><td>session_statusë¥¼ 'ì·¨ì†Œ'ë¡œ ë³€ê²½</td></tr>
<tr><td>ë…¸ì‡¼</td><td>session_statusë¥¼ 'ë…¸ì‡¼'ë¡œ ë³€ê²½</td></tr>
<tr><td>í™˜ë¶ˆ</td><td>ë§ˆì´ë„ˆìŠ¤ ì²­êµ¬ ì¶”ê°€ ë˜ëŠ” ìƒíƒœë¥¼ 'í™˜ë¶ˆ'ë¡œ</td></tr>
<tr><td>ì •ë³´ ìˆ˜ì •</td><td>UPDATE + ë³€ê²½ ì´ë ¥ ë©”ëª¨</td></tr>
<tr><td>í™˜ì íƒˆí‡´</td><td>ì‚­ì œ ëŒ€ì‹  is_active = 'N'</td></tr>
<tr><td>ë¶„í•  ê²°ì œ</td><td>ì²­êµ¬ ë¶„ë¦¬ ë˜ëŠ” ë©”ëª¨ í™œìš©</td></tr>
<tr><td>ìë³´ í™˜ì</td><td>INS004 + payment_status 'ëŒ€ê¸°'</td></tr>
</table>

<hr>

<h2>ì´ë²ˆ ì¥ ìš”ì•½</h2>

<p>ì´ë²ˆ ì¥ì—ì„œ ë°°ìš´ ê²ƒ:</p>

<ol>
<li><strong>ì·¨ì†Œ/ë…¸ì‡¼</strong> - ìƒíƒœ ë³€ê²½ìœ¼ë¡œ ì²˜ë¦¬</li>
<li><strong>í™˜ë¶ˆ</strong> - ë§ˆì´ë„ˆìŠ¤ ê¸ˆì•¡ ë˜ëŠ” ìƒíƒœ ë³€ê²½</li>
<li><strong>ìˆ˜ì •</strong> - UPDATE + ë³€ê²½ ì´ë ¥ ê¸°ë¡</li>
<li><strong>ì‚­ì œ</strong> - ìµœí›„ì˜ ìˆ˜ë‹¨, ì™¸ë˜í‚¤ ìˆœì„œ ì£¼ì˜</li>
<li><strong>ë¹„í™œì„±í™”</strong> - ì‚­ì œ ëŒ€ì‹  ê¶Œì¥</li>
<li><strong>ë³µí•© ê²°ì œ</strong> - ë¶„ë¦¬ ë˜ëŠ” ë©”ëª¨</li>
</ol>

<p>í•µì‹¬ì€ <strong>"ì‚­ì œë³´ë‹¤ëŠ” ìƒíƒœ ë³€ê²½"</strong>ì…ë‹ˆë‹¤. ë°ì´í„°ëŠ” í•œ ë²ˆ ì‚­ì œí•˜ë©´ ë³µêµ¬í•˜ê¸° ì–´ë µì§€ë§Œ, ìƒíƒœë¡œ ê´€ë¦¬í•˜ë©´ ì–¸ì œë“  ì´ë ¥ì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.</p>

<p>ë‹¤ìŒ ì¥ì—ì„œëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆì„ ë•Œ í•´ê²°í•˜ëŠ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ìœ ì§€ë³´ìˆ˜ì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤.</p>

            <div class="nav-buttons">
                <button class="nav-btn" id="prevBtn">â† ì´ì „</button>
                <span class="page-num" id="pageNum"></span>
                <button class="nav-btn" id="nextBtn">ë‹¤ìŒ â†’</button>
            </div>
        </main>
    </div>
    <script src="../js/nav.js"></script>
</body>
</html>
