<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5장: 기준 데이터 입력 - 물리치료사를 위한 데이터베이스 3권</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    @@include('components/top-nav.html', {"root": "../..", "activeBook": "3"})

    @@include('components/mobile-menu.html')

    <div class="container">
        <nav class="sidebar" id="sidebar">
            <button class="close-btn" onclick="toggleMenu()">×</button>
            <div class="sidebar-header">
                <h1>📙 물리치료사를 위한</h1>
                <p>실전 구축 & 대시보드 (3권)</p>
            </div>
            <ul class="nav-list" id="navList"></ul>
        </nav>

        <main class="main">
            <h1 class="title">기준 데이터 입력</h1>

            <h2>드디어 데이터를 넣습니다!</h2>

            <p>4권까지 해서 데이터베이스 구조가 완성되었습니다. 테이블 9개, 관계 설정 완료, 제약조건 추가 완료. 하지만 지금 테이블들은 전부 비어있어요. 빈 그릇만 있고 음식이 없는 상태입니다.</p>

            <p>이번 장부터 본격적으로 데이터를 채워넣습니다. 순서가 중요해요. 외래키 때문에 참조되는 테이블에 먼저 데이터가 있어야 합니다.</p>

            <h3>데이터 입력 순서</h3>

            <ol>
                <li><strong>5권 (이번 장)</strong>: 기준 데이터
                    <ul>
                        <li>insurances - 보험사 (5개)</li>
                        <li>fee_items - 수가 항목 (8개)</li>
                        <li>diagnosis_codes - 진단 코드 (20개)</li>
                        <li>therapists - 치료사 (4명)</li>
                    </ul>
                </li>
                <li><strong>6권 (다음 장)</strong>: 업무 데이터
                    <ul>
                        <li>patients - 환자 (30명)</li>
                        <li>patient_diagnoses - 환자별 진단</li>
                        <li>treatment_sessions - 치료 기록 (500건)</li>
                        <li>billings - 청구/수납</li>
                        <li>soap_notes - SOAP 기록</li>
                    </ul>
                </li>
            </ol>

            <p>기준 데이터는 자주 바뀌지 않는 "코드성" 데이터입니다. 보험사 목록, 치료 항목, 진단 코드 같은 것들이요. 이런 데이터가 먼저 있어야 환자나 치료 기록을 입력할 수 있습니다.</p>

            <hr>

            <h2>1. 보험사 데이터 (insurances)</h2>

            <p>환자들이 가입한 보험사 정보입니다. 국민건강보험은 거의 모든 환자가 해당되고, 그 외 실손보험이나 자동차보험 등이 있습니다.</p>

            <pre><code>-- 보험사 데이터 입력
INSERT INTO insurances (insurance_code, insurance_name, insurance_type, contact_number) VALUES
('INS001', '국민건강보험공단', '건강보험', '1577-1000'),
('INS002', '삼성화재', '실손보험', '1588-5114'),
('INS003', '현대해상', '실손보험', '1588-5656'),
('INS004', 'DB손해보험', '자동차보험', '1588-0100'),
('INS005', '메리츠화재', '실손보험', '1566-7711');</code></pre>

            <p>각 행이 뭘 의미하는지 설명하자면:</p>

            <ul>
                <li><strong>INS001 - 국민건강보험공단</strong>: 대부분의 환자가 가입. 건강보험 적용 치료 시 사용</li>
                <li><strong>INS002~003, INS005 - 실손보험사</strong>: 비급여 치료비 청구 시 필요</li>
                <li><strong>INS004 - DB손해보험</strong>: 교통사고 환자의 자동차보험 청구 시 사용</li>
            </ul>

            <h3>✅ 체크포인트</h3>

            <pre><code>-- 입력 확인
SELECT * FROM insurances;</code></pre>

            <p>5개 행이 보이면 성공!</p>

            <hr>

            <h2>2. 수가 항목 데이터 (fee_items)</h2>

            <p>힐링손 물리치료센터에서 제공하는 치료 서비스와 가격표입니다. 실제 물리치료 클리닉의 수가를 참고해서 만들었어요.</p>

            <pre><code>-- 수가 항목 데이터 입력
INSERT INTO fee_items (fee_code, fee_name, fee_category, unit_price, duration_minutes, is_active) VALUES
('FEE001', '도수치료 30분', '도수', 80000, 30, 'Y'),
('FEE002', '도수치료 60분', '도수', 150000, 60, 'Y'),
('FEE003', '운동치료 30분', '운동', 50000, 30, 'Y'),
('FEE004', '운동치료 60분', '운동', 90000, 60, 'Y'),
('FEE005', '체외충격파', '물리', 30000, 15, 'Y'),
('FEE006', '슈로스 측만증 치료', '운동', 100000, 50, 'Y'),
('FEE007', '산재/자동차 도수치료', '도수', 100000, 30, 'Y'),
('FEE008', '초진 상담', '상담', 0, 20, 'Y');</code></pre>

            <p>각 항목 설명:</p>

            <table>
                <tr><th>코드</th><th>항목명</th><th>가격</th><th>설명</th></tr>
                <tr><td>FEE001</td><td>도수치료 30분</td><td>80,000원</td><td>가장 많이 하는 치료</td></tr>
                <tr><td>FEE002</td><td>도수치료 60분</td><td>150,000원</td><td>중증 환자용</td></tr>
                <tr><td>FEE003</td><td>운동치료 30분</td><td>50,000원</td><td>최준호 치료사 담당</td></tr>
                <tr><td>FEE004</td><td>운동치료 60분</td><td>90,000원</td><td>집중 운동치료</td></tr>
                <tr><td>FEE005</td><td>체외충격파</td><td>30,000원</td><td>장비 치료</td></tr>
                <tr><td>FEE006</td><td>슈로스 측만증 치료</td><td>100,000원</td><td>특수 치료</td></tr>
                <tr><td>FEE007</td><td>산재/자동차 도수치료</td><td>100,000원</td><td>보험 청구용</td></tr>
                <tr><td>FEE008</td><td>초진 상담</td><td>무료</td><td>첫 방문 상담</td></tr>
            </table>

            <h3>✅ 체크포인트</h3>

            <pre><code>-- 입력 확인
SELECT fee_code, fee_name, unit_price FROM fee_items ORDER BY fee_code;</code></pre>

            <p>8개 행이 보이면 성공!</p>

            <hr>

            <h2>3. 진단 코드 데이터 (diagnosis_codes)</h2>

            <p>의료에서 사용하는 KCD (Korean Standard Classification of Diseases) 코드입니다. 물리치료에서 자주 다루는 진단 위주로 20개를 입력합니다.</p>

            <pre><code>-- 진단 코드 데이터 입력
INSERT INTO diagnosis_codes (diagnosis_code, diagnosis_name, diagnosis_category, description) VALUES
-- 척추 관련
('M54.5', '요통', '척추', '허리 통증, 원인 불명의 요통'),
('M54.2', '경추통', '척추', '목 통증'),
('M51.1', '요추 추간판장애', '척추', '허리 디스크'),
('M50.1', '경추 추간판장애', '척추', '목 디스크'),
('M47.8', '기타 척추증', '척추', '퇴행성 척추 질환'),
('M48.0', '척추관 협착증', '척추', '척추관이 좁아진 상태'),

-- 어깨 관련
('M75.1', '회전근개 증후군', '어깨', '어깨 회전근개 손상'),
('M75.0', '유착성 관절낭염', '어깨', '오십견, 동결견'),
('M75.4', '충돌 증후군', '어깨', '어깨 충돌 증후군'),

-- 무릎 관련
('M17.1', '원발성 무릎관절증', '무릎', '무릎 퇴행성 관절염'),
('M23.5', '무릎의 만성 불안정성', '무릎', '무릎 인대 손상 후유증'),
('S83.5', '무릎 염좌 및 긴장', '무릎', '무릎 인대 손상'),

-- 기타 관절
('M77.1', '외측 상과염', '팔꿈치', '테니스 엘보'),
('M77.0', '내측 상과염', '팔꿈치', '골프 엘보'),
('M79.3', '지절통', '기타', '손가락 관절 통증'),

-- 근육/연부조직
('M79.1', '근육통', '근육', '근육 통증'),
('M62.8', '기타 근육장애', '근육', '근육 경직, 긴장'),
('M70.0', '손목의 건초염', '손목', '손목 건초염'),

-- 자세/체형
('M41.1', '청소년기 특발성 측만증', '척추', '측만증'),
('M40.0', '자세성 후만증', '척추', '굽은 등');</code></pre>

            <p>물리치료사라면 이 진단명들이 익숙하실 거예요. 실제 임상에서 가장 많이 보는 진단들입니다.</p>

            <h3>✅ 체크포인트</h3>

            <pre><code>-- 카테고리별 개수 확인
SELECT diagnosis_category, COUNT(*) as 개수
FROM diagnosis_codes
GROUP BY diagnosis_category
ORDER BY 개수 DESC;</code></pre>

            <p>결과:</p>
            <pre><code>+--------------------+------+
| diagnosis_category | 개수 |
+--------------------+------+
| 척추               |    7 |
| 어깨               |    3 |
| 무릎               |    3 |
| 팔꿈치             |    2 |
| 근육               |    2 |
| 손목               |    1 |
| 기타               |    1 |
+--------------------+------+</code></pre>

            <p>총 20개, 카테고리별로 잘 분류되어 있으면 성공!</p>

            <hr>

            <h2>4. 치료사 데이터 (therapists)</h2>

            <p>드디어 힐링손 물리치료센터의 주인공들이 등장합니다. 1권에서 소개했던 김지훈 원장과 세 명의 치료사입니다.</p>

            <pre><code>-- 치료사 데이터 입력
INSERT INTO therapists (therapist_id, name, license_number, phone, email, specialization, hire_date, is_active) VALUES
('T001', '김지훈', 'PT-2014-12345', '010-1111-0001', 'jihoon.kim@healinghands.com', '도수치료, 척추질환', '2023-01-02', 'Y'),
('T002', '박민수', 'PT-2017-23456', '010-1111-0002', 'minsu.park@healinghands.com', '스포츠재활, 어깨/무릎', '2023-01-15', 'Y'),
('T003', '이서연', 'PT-2019-34567', '010-1111-0003', 'seoyeon.lee@healinghands.com', '도수치료, 만성통증', '2023-03-01', 'Y'),
('T004', '최준호', 'PT-2021-45678', '010-1111-0004', 'junho.choi@healinghands.com', '운동치료, 자세교정', '2023-06-01', 'Y');</code></pre>

            <p>각 치료사의 특징을 다시 정리하면:</p>

            <table>
                <tr><th>ID</th><th>이름</th><th>역할</th><th>전문분야</th><th>입사일</th></tr>
                <tr><td>T001</td><td>김지훈</td><td>원장</td><td>도수치료, 척추질환</td><td>2023-01-02 (개원일)</td></tr>
                <tr><td>T002</td><td>박민수</td><td>치료사</td><td>스포츠재활, 어깨/무릎</td><td>2023-01-15</td></tr>
                <tr><td>T003</td><td>이서연</td><td>치료사</td><td>도수치료, 만성통증</td><td>2023-03-01</td></tr>
                <tr><td>T004</td><td>최준호</td><td>치료사</td><td>운동치료, 자세교정</td><td>2023-06-01</td></tr>
            </table>

            <div class="tip"><strong>💡 면허번호 형식</strong><br>
            면허번호는 실제 형식과 다릅니다. 예시용으로 'PT-연도-번호' 형식을 사용했어요. 실제로는 보건복지부에서 발급하는 공식 형식이 있습니다.</div>

            <h3>✅ 체크포인트</h3>

            <pre><code>-- 치료사 목록 확인
SELECT therapist_id, name, specialization, hire_date
FROM therapists
ORDER BY hire_date;</code></pre>

            <p>4명의 치료사가 입사일 순으로 보이면 성공!</p>

            <hr>

            <h2>전체 기준 데이터 확인</h2>

            <p>지금까지 입력한 기준 데이터를 정리해볼까요?</p>

            <pre><code>-- 각 테이블의 데이터 개수 확인
SELECT 'insurances' as 테이블, COUNT(*) as 개수 FROM insurances
UNION ALL
SELECT 'fee_items', COUNT(*) FROM fee_items
UNION ALL
SELECT 'diagnosis_codes', COUNT(*) FROM diagnosis_codes
UNION ALL
SELECT 'therapists', COUNT(*) FROM therapists;</code></pre>

            <p>결과:</p>
            <pre><code>+-----------------+------+
| 테이블          | 개수 |
+-----------------+------+
| insurances      |    5 |
| fee_items       |    8 |
| diagnosis_codes |   20 |
| therapists      |    4 |
+-----------------+------+</code></pre>

            <p>이렇게 나오면 기준 데이터 입력 완료입니다!</p>

            <hr>

            <h2>Metabase 연결 테스트</h2>

            <p>2권에서 Metabase를 설치하고 MySQL 연결 설정을 해두었죠? 이제 데이터가 있으니 연결이 제대로 되는지 확인해봅시다.</p>

            <ol>
                <li>Metabase 접속: <code>http://localhost:3000</code></li>
                <li>로그인</li>
                <li>오른쪽 상단 "새로 만들기" → "질문"</li>
                <li>데이터베이스 선택: "힐링손 DB" (또는 설정한 이름)</li>
                <li>테이블 선택: "therapists"</li>
                <li>"시각화" 클릭</li>
            </ol>

            <p>치료사 4명의 데이터가 테이블로 보이면 Metabase 연결 성공입니다!</p>

            <div class="warning"><strong>⚠️ 연결이 안 된다면?</strong><br>
            <ul>
                <li>Docker가 실행 중인지 확인 (<code>docker ps</code>)</li>
                <li>Metabase가 실행 중인지 확인</li>
                <li>MySQL이 실행 중인지 확인</li>
                <li>Metabase의 데이터베이스 설정에서 호스트가 <code>host.docker.internal</code>인지 확인</li>
                <li>데이터베이스 이름이 <code>healing_hands</code>인지 확인</li>
            </ul>
            </div>

            <hr>

            <h2>이번 장 요약</h2>

            <p>이번 장에서 입력한 데이터:</p>

            <table>
                <tr><th>테이블</th><th>데이터</th><th>개수</th></tr>
                <tr><td>insurances</td><td>보험사 (국민건강보험, 실손보험 등)</td><td>5개</td></tr>
                <tr><td>fee_items</td><td>수가 항목 (도수치료, 운동치료 등)</td><td>8개</td></tr>
                <tr><td>diagnosis_codes</td><td>진단 코드 (요통, 디스크, 오십견 등)</td><td>20개</td></tr>
                <tr><td>therapists</td><td>치료사 (김지훈, 박민수, 이서연, 최준호)</td><td>4명</td></tr>
            </table>

            <p>이 데이터들은 앞으로 환자를 등록하고 치료 기록을 입력할 때 참조됩니다. 환자의 보험사, 받은 치료 종류, 진단명, 담당 치료사... 모두 여기서 선택하게 됩니다.</p>

            <p>다음 장에서는 진짜 업무 데이터를 입력합니다. 환자 30명, 그리고 3개월치 치료 기록 약 500건! 힐링손 물리치료센터가 실제로 운영되는 것처럼 현실적인 데이터를 만들어볼 거예요.</p>

            <div class="nav-buttons">
                <button class="nav-btn" id="prevBtn">← 이전</button>
                <span class="page-num" id="pageNum"></span>
                <button class="nav-btn" id="nextBtn">다음 →</button>
            </div>
        </main>
    </div>

    <script src="../js/nav.js"></script>
</body>
</html>
