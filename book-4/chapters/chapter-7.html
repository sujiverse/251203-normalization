<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7ì¥: MySQL ì—°ê²° - ë¬¼ë¦¬ì¹˜ë£Œì‚¬ë¥¼ ìœ„í•œ DB 4ê¶Œ</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    @@include('components/top-nav.html', {"root": "../..", "activeBook": "4"})

    @@include('components/mobile-menu.html')

    <div class="container">
        <nav class="sidebar" id="sidebar">
            <button class="close-btn" onclick="toggleMenu()">Ã—</button>
            <div class="sidebar-header">
                <h1>ğŸ“• ë¬¼ë¦¬ì¹˜ë£Œì‚¬ë¥¼ ìœ„í•œ</h1>
                <p>ì›¹ ì•± ë§Œë“¤ê¸° (4ê¶Œ)</p>
            </div>
            <ul class="nav-list" id="navList"></ul>
        </nav>

        <main class="main">
            <h1 class="title">MySQL ì—°ê²°</h1>

            <h2>ë“œë””ì–´ ì§„ì§œ ë°ì´í„°!</h2>

            <p>ì§€ê¸ˆê¹Œì§€ëŠ” Python ë¦¬ìŠ¤íŠ¸ì— ì„ì‹œ ë°ì´í„°ë¥¼ ë„£ì–´ì„œ í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤. ì´ì œ 3ê¶Œì—ì„œ ë§Œë“  MySQL ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ê²°í•©ë‹ˆë‹¤.</p>

            <hr>

            <h2>ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜</h2>

            <pre><code># ê°€ìƒí™˜ê²½ í™œì„±í™” í™•ì¸ í›„
pip install pymysql</code></pre>

            <div class="tip"><strong>ğŸ’¡ pymysql vs mysql-connector</strong><br>
            ë‘˜ ë‹¤ MySQL ì—°ê²° ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. pymysqlì´ ì„¤ì¹˜ê°€ ë” ê°„ë‹¨í•´ì„œ ì´ ì±…ì—ì„œëŠ” pymysqlì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</div>

            <hr>

            <h2>ê¸°ë³¸ ì—°ê²° í…ŒìŠ¤íŠ¸</h2>

            <pre><code>import pymysql

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
connection = pymysql.connect(
    host='localhost',
    user='root',
    password='your_password',  # ë³¸ì¸ ë¹„ë°€ë²ˆí˜¸
    database='healing_hands',
    charset='utf8mb4'
)

# ì»¤ì„œ ìƒì„±
cursor = connection.cursor()

# ì¿¼ë¦¬ ì‹¤í–‰
cursor.execute("SELECT * FROM patients LIMIT 5")

# ê²°ê³¼ ê°€ì ¸ì˜¤ê¸°
results = cursor.fetchall()
for row in results:
    print(row)

# ì—°ê²° ì¢…ë£Œ
cursor.close()
connection.close()</code></pre>

            <h3>ì‹¤í–‰ ê²°ê³¼ (ì˜ˆì‹œ)</h3>
            <pre><code>(1, 'ê¹€ì² ìˆ˜', '010-1234-5678', '1985-03-15', ...)
(2, 'ì´ì˜í¬', '010-2345-6789', '1990-07-22', ...)
...</code></pre>

            <hr>

            <h2>Flaskì™€ í†µí•©</h2>

            <p>Flask ì•±ì—ì„œ MySQLì„ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤.</p>

            <pre><code>from flask import Flask, jsonify
import pymysql

app = Flask(__name__)
app.config['JSON_AS_ASCII'] = False

# DB ì—°ê²° í•¨ìˆ˜
def get_db_connection():
    return pymysql.connect(
        host='localhost',
        user='root',
        password='your_password',
        database='healing_hands',
        charset='utf8mb4',
        cursorclass=pymysql.cursors.DictCursor  # ê²°ê³¼ë¥¼ ë”•ì…”ë„ˆë¦¬ë¡œ
    )

@app.route('/api/patients')
def get_patients():
    conn = get_db_connection()
    try:
        cursor = conn.cursor()
        cursor.execute("SELECT patient_id, name, phone, birth_date FROM patients")
        patients = cursor.fetchall()
        return jsonify({
            'success': True,
            'data': patients,
            'count': len(patients)
        })
    finally:
        conn.close()

if __name__ == '__main__':
    app.run(debug=True)</code></pre>

            <hr>

            <h2>DictCursor ì‚¬ìš©í•˜ê¸°</h2>

            <p>ê¸°ë³¸ ì»¤ì„œëŠ” íŠœí”Œì„ ë°˜í™˜í•©ë‹ˆë‹¤. <code>DictCursor</code>ë¥¼ ì‚¬ìš©í•˜ë©´ ë”•ì…”ë„ˆë¦¬ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.</p>

            <h3>ê¸°ë³¸ ì»¤ì„œ (íŠœí”Œ)</h3>
            <pre><code>(1, 'ê¹€ì² ìˆ˜', '010-1234-5678')
# row[0], row[1], row[2] ë¡œ ì ‘ê·¼</code></pre>

            <h3>DictCursor (ë”•ì…”ë„ˆë¦¬)</h3>
            <pre><code>{'patient_id': 1, 'name': 'ê¹€ì² ìˆ˜', 'phone': '010-1234-5678'}
# row['name'], row['phone'] ìœ¼ë¡œ ì ‘ê·¼</code></pre>

            <div class="tip"><strong>ğŸ’¡ DictCursorê°€ í¸ë¦¬í•œ ì´ìœ </strong><br>
            JSON ì‘ë‹µì„ ë§Œë“¤ ë•Œ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ë©´ ë©ë‹ˆë‹¤. ì»¬ëŸ¼ ìˆœì„œë¥¼ ê¸°ì–µí•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.</div>

            <hr>

            <h2>ì—ëŸ¬ ì²˜ë¦¬</h2>

            <pre><code>@app.route('/api/patients/&lt;int:patient_id&gt;')
def get_patient(patient_id):
    conn = get_db_connection()
    try:
        cursor = conn.cursor()
        cursor.execute(
            "SELECT * FROM patients WHERE patient_id = %s",
            (patient_id,)
        )
        patient = cursor.fetchone()

        if patient:
            return jsonify({'success': True, 'data': patient})
        else:
            return jsonify({
                'success': False,
                'error': 'í™˜ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤'
            }), 404

    except pymysql.Error as e:
        return jsonify({
            'success': False,
            'error': f'ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜: {str(e)}'
        }), 500

    finally:
        conn.close()</code></pre>

            <hr>

            <h2>SQL ì¸ì ì…˜ ë°©ì§€</h2>

            <div class="danger"><strong>ğŸš¨ ì ˆëŒ€ í•˜ë©´ ì•ˆ ë˜ëŠ” ê²ƒ!</strong></div>

            <pre><code># âŒ ìœ„í—˜! SQL ì¸ì ì…˜ ì·¨ì•½ì 
cursor.execute(f"SELECT * FROM patients WHERE name = '{name}'")</code></pre>

            <h3>ì•ˆì „í•œ ë°©ë²•</h3>
            <pre><code># âœ… ì•ˆì „! íŒŒë¼ë¯¸í„° ë°”ì¸ë”©
cursor.execute(
    "SELECT * FROM patients WHERE name = %s",
    (name,)
)</code></pre>

            <p><code>%s</code> í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ì‚¬ìš©í•˜ê³ , ê°’ì„ íŠœí”Œë¡œ ì „ë‹¬í•˜ë©´ ìë™ìœ¼ë¡œ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ë©ë‹ˆë‹¤.</p>

            <hr>

            <h2>ì„¤ì • ë¶„ë¦¬í•˜ê¸°</h2>

            <p>ë¹„ë°€ë²ˆí˜¸ ê°™ì€ ì •ë³´ëŠ” ì½”ë“œì— ì§ì ‘ ì“°ì§€ ì•ŠëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤.</p>

            <h3>config.py íŒŒì¼ ìƒì„±</h3>
            <pre><code># config.py
DB_CONFIG = {
    'host': 'localhost',
    'user': 'root',
    'password': 'your_password',
    'database': 'healing_hands',
    'charset': 'utf8mb4'
}</code></pre>

            <h3>app.pyì—ì„œ ì‚¬ìš©</h3>
            <pre><code>from config import DB_CONFIG

def get_db_connection():
    return pymysql.connect(
        **DB_CONFIG,
        cursorclass=pymysql.cursors.DictCursor
    )</code></pre>

            <div class="warning"><strong>âš ï¸ config.pyëŠ” .gitignoreì— ì¶”ê°€</strong><br>
            ë¹„ë°€ë²ˆí˜¸ê°€ í¬í•¨ëœ íŒŒì¼ì€ Gitì— ì˜¬ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>

            <hr>

            <h2>ì—°ê²° í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>

            <table>
                <tr>
                    <th>í•­ëª©</th>
                    <th>í™•ì¸</th>
                </tr>
                <tr>
                    <td>MySQL ì„œë²„ ì‹¤í–‰ ì¤‘</td>
                    <td>ì„œë¹„ìŠ¤/ë°ëª¬ í™•ì¸</td>
                </tr>
                <tr>
                    <td>healing_hands DB ì¡´ì¬</td>
                    <td>DBeaverì—ì„œ í™•ì¸</td>
                </tr>
                <tr>
                    <td>ë¹„ë°€ë²ˆí˜¸ ì •í™•</td>
                    <td>ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</td>
                </tr>
                <tr>
                    <td>pymysql ì„¤ì¹˜ë¨</td>
                    <td>pip list í™•ì¸</td>
                </tr>
                <tr>
                    <td>API ì‘ë‹µ í™•ì¸</td>
                    <td>/api/patients ì ‘ì†</td>
                </tr>
            </table>

            <hr>

            <h2>ì´ë²ˆ ì¥ ì •ë¦¬</h2>

            <ul>
                <li><code>pymysql</code>ë¡œ MySQLì— ì—°ê²°í•©ë‹ˆë‹¤</li>
                <li><code>DictCursor</code>ë¡œ ë”•ì…”ë„ˆë¦¬ ê²°ê³¼ë¥¼ ë°›ìŠµë‹ˆë‹¤</li>
                <li><code>%s</code> íŒŒë¼ë¯¸í„°ë¡œ SQL ì¸ì ì…˜ì„ ë°©ì§€í•©ë‹ˆë‹¤</li>
                <li>ì„¤ì •ì€ ë³„ë„ íŒŒì¼ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤</li>
            </ul>

            <blockquote>ë‹¤ìŒ ì¥ì—ì„œëŠ” í™˜ì ëª©ë¡ APIë¥¼ ì™„ì„±í•©ë‹ˆë‹¤. ê²€ìƒ‰, í˜ì´ì§•ê¹Œì§€!</blockquote>

            <div class="nav-buttons">
                <button class="nav-btn" id="prevBtn">â† ì´ì „</button>
                <span class="page-num" id="pageNum"></span>
                <button class="nav-btn" id="nextBtn">ë‹¤ìŒ â†’</button>
            </div>
        </main>
    </div>
    <script src="../js/nav.js"></script>
</body>
</html>
