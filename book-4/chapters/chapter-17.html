<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>17ì¥: ì…€ ìŠ¤íƒ€ì¼ ì»¤ìŠ¤í„°ë§ˆì´ì§• - ë¬¼ë¦¬ì¹˜ë£Œì‚¬ë¥¼ ìœ„í•œ DB 4ê¶Œ</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    @@include('components/top-nav.html', {"root": "../..", "activeBook": "4"})

    @@include('components/mobile-menu.html')

    <div class="container">
        <nav class="sidebar" id="sidebar">
            <button class="close-btn" onclick="toggleMenu()">Ã—</button>
            <div class="sidebar-header">
                <h1>ğŸ“• ë¬¼ë¦¬ì¹˜ë£Œì‚¬ë¥¼ ìœ„í•œ</h1>
                <p>ì›¹ ì•± ë§Œë“¤ê¸° (4ê¶Œ)</p>
            </div>
            <ul class="nav-list" id="navList"></ul>
        </nav>

        <main class="main">
            <h1 class="title">ì…€ ìŠ¤íƒ€ì¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•</h1>

            <h2>ì…€ ìŠ¤íƒ€ì¼ ì†ì„±</h2>

            <table>
                <tr>
                    <th>ì†ì„±</th>
                    <th>ì„¤ëª…</th>
                    <th>ì˜ˆì‹œ</th>
                </tr>
                <tr>
                    <td>bg</td>
                    <td>ë°°ê²½ìƒ‰</td>
                    <td>#ffffff</td>
                </tr>
                <tr>
                    <td>fc</td>
                    <td>ê¸€ììƒ‰</td>
                    <td>#000000</td>
                </tr>
                <tr>
                    <td>fs</td>
                    <td>ê¸€ì í¬ê¸°</td>
                    <td>12</td>
                </tr>
                <tr>
                    <td>bl</td>
                    <td>êµµê²Œ</td>
                    <td>1 (í™œì„±), 0 (ë¹„í™œì„±)</td>
                </tr>
                <tr>
                    <td>it</td>
                    <td>ê¸°ìš¸ì„</td>
                    <td>1 (í™œì„±)</td>
                </tr>
                <tr>
                    <td>ht</td>
                    <td>ê°€ë¡œ ì •ë ¬</td>
                    <td>0:ì™¼ìª½, 1:ê°€ìš´ë°, 2:ì˜¤ë¥¸ìª½</td>
                </tr>
                <tr>
                    <td>vt</td>
                    <td>ì„¸ë¡œ ì •ë ¬</td>
                    <td>0:ìœ„, 1:ê°€ìš´ë°, 2:ì•„ë˜</td>
                </tr>
            </table>

            <hr>

            <h2>ìŠ¤íƒ€ì¼ ì ìš© ì˜ˆì‹œ</h2>

            <pre><code>// í—¤ë” ì…€ ìŠ¤íƒ€ì¼
const headerStyle = {
    bg: '#1e293b',     // ì§„í•œ ë°°ê²½
    fc: '#ffffff',     // í° ê¸€ì
    bl: 1,             // êµµê²Œ
    ht: 1,             // ê°€ìš´ë° ì •ë ¬
    vt: 1,             // ì„¸ë¡œ ê°€ìš´ë°
    fs: 12             // ê¸€ì í¬ê¸°
};

// í™˜ìëª… ì…€ ìŠ¤íƒ€ì¼
const patientNameStyle = {
    bg: '#fee2e2',     // ì—°í•œ ë¹¨ê°•
    fc: '#991b1b',     // ì§„í•œ ë¹¨ê°•
    bl: 1,
    ht: 0              // ì™¼ìª½ ì •ë ¬
};

// ì˜ˆì•½ ì…€ ìŠ¤íƒ€ì¼ (ì¹˜ë£Œì‚¬ë³„)
const therapistStyles = {
    'ê¹€ì¹˜ë£Œ': { bg: '#dbeafe', fc: '#1e40af' },  // íŒŒë‘
    'ì´ì¹˜ë£Œ': { bg: '#fef3c7', fc: '#92400e' },  // ë…¸ë‘
    'ë°•ì¹˜ë£Œ': { bg: '#dcfce7', fc: '#166534' },  // ì´ˆë¡
    'ìµœì¹˜ë£Œ': { bg: '#f3e8ff', fc: '#6b21a8' }   // ë³´ë¼
};</code></pre>

            <hr>

            <h2>ìŠ¤íƒ€ì¼ í•¨ìˆ˜ ë§Œë“¤ê¸°</h2>

            <pre><code>// ì…€ ê°’ ìƒì„± í—¬í¼
function createCell(value, displayValue, style = {}) {
    return {
        v: value,
        m: displayValue || value,
        ...style
    };
}

// í—¤ë” ì…€
function createHeaderCell(value) {
    return createCell(value, value, {
        bg: '#1e293b',
        fc: '#ffffff',
        bl: 1,
        ht: 1,
        vt: 1
    });
}

// í™˜ìëª… ì…€
function createPatientCell(id, name) {
    return createCell(id, name, {
        bg: '#fee2e2',
        fc: '#991b1b',
        bl: 1
    });
}

// ì˜ˆì•½ ì…€
function createReservationCell(time, therapist) {
    const style = therapistStyles[therapist] || { bg: '#f1f5f9' };
    return createCell(time, time, {
        ...style,
        ht: 1  // ê°€ìš´ë° ì •ë ¬
    });
}</code></pre>

            <hr>

            <h2>ê°œì„ ëœ ì‹œíŠ¸ ìƒì„± ì½”ë“œ</h2>

            <pre><code>function createHeaderRow(dates) {
    const cells = [
        {
            r: 0, c: 0,
            v: createHeaderCell('í™˜ìëª…')
        }
    ];

    dates.forEach((d, i) => {
        cells.push({
            r: 0,
            c: i + 1,
            v: createHeaderCell(d.display)
        });
    });

    return cells;
}

function createPatientRows(patients) {
    return patients.map((patient, i) => ({
        r: i + 1,
        c: 0,
        v: createPatientCell(patient.patient_id, patient.name)
    }));
}

function createReservationCells(patients, dates, reservations) {
    const cells = [];

    patients.forEach((patient, rowIdx) => {
        const patientRes = reservations[patient.patient_id] || {};

        dates.forEach((d, colIdx) => {
            const res = patientRes[d.date];
            if (res) {
                cells.push({
                    r: rowIdx + 1,
                    c: colIdx + 1,
                    v: createReservationCell(res.time, res.therapist)
                });
            }
        });
    });

    return cells;
}</code></pre>

            <hr>

            <h2>ì£¼ë§ í‘œì‹œí•˜ê¸°</h2>

            <pre><code>function getDateStyle(dateObj) {
    const day = dateObj.getDay();

    if (day === 0) {  // ì¼ìš”ì¼
        return { bg: '#fef2f2', fc: '#dc2626' };
    } else if (day === 6) {  // í† ìš”ì¼
        return { bg: '#eff6ff', fc: '#2563eb' };
    }

    return { bg: '#f8fafc', fc: '#334155' };
}

function createHeaderRow(dates) {
    const cells = [
        { r: 0, c: 0, v: createHeaderCell('í™˜ìëª…') }
    ];

    dates.forEach((d, i) => {
        const dateObj = new Date(d.date);
        const style = getDateStyle(dateObj);

        cells.push({
            r: 0,
            c: i + 1,
            v: {
                v: d.date,
                m: d.display,
                bl: 1,
                ht: 1,
                ...style
            }
        });
    });

    return cells;
}</code></pre>

            <hr>

            <h2>ë²”ë¡€ ì¶”ê°€</h2>

            <p>ì¹˜ë£Œì‚¬ë³„ ìƒ‰ìƒ ë²”ë¡€ë¥¼ í˜ì´ì§€ì— í‘œì‹œí•©ë‹ˆë‹¤.</p>

            <pre><code>&lt;!-- HTML --&gt;
&lt;div class="legend"&gt;
    &lt;h3&gt;ì¹˜ë£Œì‚¬&lt;/h3&gt;
    &lt;div class="legend-items" id="therapistLegend"&gt;&lt;/div&gt;
&lt;/div&gt;

// JavaScript
async function loadTherapistLegend() {
    const res = await fetch('/api/therapists');
    const { data: therapists } = await res.json();

    const container = document.getElementById('therapistLegend');
    container.innerHTML = therapists.map(t => {
        const color = therapistStyles[t.name]?.bg || '#f1f5f9';
        return `
            &lt;div class="legend-item"&gt;
                &lt;span class="color-box" style="background: ${color}"&gt;&lt;/span&gt;
                &lt;span&gt;${t.name}&lt;/span&gt;
            &lt;/div&gt;
        `;
    }).join('');
}</code></pre>

            <pre><code>/* CSS */
.legend {
    padding: 10px 20px;
    background: white;
    border-radius: 8px;
    margin-bottom: 10px;
}

.legend-items {
    display: flex;
    gap: 15px;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 5px;
}

.color-box {
    width: 16px;
    height: 16px;
    border-radius: 3px;
    border: 1px solid #ddd;
}</code></pre>

            <hr>

            <h2>ì´ë²ˆ ì¥ ì •ë¦¬</h2>

            <ul>
                <li>ì…€ ìŠ¤íƒ€ì¼ ì†ì„±: bg, fc, fs, bl, ht, vt ë“±</li>
                <li>ì¹˜ë£Œì‚¬ë³„ ìƒ‰ìƒìœ¼ë¡œ êµ¬ë¶„í•©ë‹ˆë‹¤</li>
                <li>ì£¼ë§ì€ ë‹¤ë¥¸ ìƒ‰ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤</li>
                <li>ë²”ë¡€ë¡œ ìƒ‰ìƒ ì˜ë¯¸ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤</li>
            </ul>

            <blockquote>ë‹¤ìŒ ì¥ì—ì„œëŠ” í–‰/ì—´ ê³ ì •ì„ ì„¤ì •í•©ë‹ˆë‹¤!</blockquote>

            <div class="nav-buttons">
                <button class="nav-btn" id="prevBtn">â† ì´ì „</button>
                <span class="page-num" id="pageNum"></span>
                <button class="nav-btn" id="nextBtn">ë‹¤ìŒ â†’</button>
            </div>
        </main>
    </div>
    <script src="../js/nav.js"></script>
</body>
</html>
