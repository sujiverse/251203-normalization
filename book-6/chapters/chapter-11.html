<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[11ì¥] ì¢…ë‹¨ ì—°êµ¬ - ì—°êµ¬ ë°ì´í„° ì„¤ê³„</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <nav class="top-nav">
        <a href="../../index.html" class="top-nav-brand"><span>ğŸ“Š</span> ì—°êµ¬ ë°ì´í„° ì„¤ê³„</a>
        <div class="top-nav-links">
            <a href="../../book-1/index.html" class="top-nav-link book-1">1ê¶Œ</a>
            <a href="../../book-2/index.html" class="top-nav-link book-2">2ê¶Œ</a>
            <a href="../../book-3/index.html" class="top-nav-link book-3">3ê¶Œ</a>
            <a href="../../book-4/index.html" class="top-nav-link book-4">4ê¶Œ</a>
            <a href="../../book-5/index.html" class="top-nav-link book-5">5ê¶Œ</a>
            <a href="../../book-6/index.html" class="top-nav-link book-6 active">6ê¶Œ</a>
        </div>
    </nav>
    <button class="menu-toggle" onclick="toggleMenu()">â˜°</button>
    <div class="overlay" id="overlay" onclick="toggleMenu()"></div>
    <div class="container">
        <nav class="sidebar" id="sidebar">
            <button class="close-btn" onclick="toggleMenu()">Ã—</button>
            <div class="sidebar-header"><h1>ğŸ“˜ 6ê¶Œ: ì—°êµ¬ ë°ì´í„° ì„¤ê³„</h1><p>ë³€ìˆ˜ë¶€í„° íšŒê·€ë¶„ì„ê¹Œì§€</p></div>
            <ul class="nav-list" id="navList"></ul>
        </nav>
        <main class="main">
            <div class="part-header">3ë¶€: ì—°êµ¬ í˜•íƒœë³„ DB ì„¤ê³„</div>
            <h1 class="title">[11ì¥] ì¢…ë‹¨ ì—°êµ¬ (Longitudinal)</h1>

            <div class="intro-box">
                <p>ì´ ì¥ì—ì„œëŠ” <strong>ì‹œê°„ì— ë”°ë¼ ë°˜ë³µ ì¸¡ì •í•˜ëŠ” ì¢…ë‹¨ ì—°êµ¬</strong>ì˜ DB ì„¤ê³„ë¥¼ ë°°ì›ë‹ˆë‹¤. Wide vs Long í˜•ì‹ì˜ í•µì‹¬ ì°¨ì´, ì‹œì  ê´€ë¦¬, íƒˆë½ ì²˜ë¦¬ ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.</p>
            </div>

            <hr>

            <h2>1. ì¢…ë‹¨ ì—°êµ¬ì˜ ì¢…ë¥˜</h2>

            <div class="concept-box">
                <h3>ğŸ“– ì¢…ë‹¨ ì—°êµ¬(Longitudinal Study)ë€?</h3>
                <p>ë™ì¼í•œ ë³€ìˆ˜ë¥¼ <strong>2íšŒ ì´ìƒ</strong> ì‹œê°„ ê°„ê²©ì„ ë‘ê³  ì¸¡ì •í•˜ëŠ” ì—°êµ¬ ì„¤ê³„ì…ë‹ˆë‹¤. ì‹œê°„ì— ë”°ë¥¸ ë³€í™”ë¥¼ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>

            <h3>1.1 íŒ¨ë„ ì—°êµ¬ (Panel Study)</h3>

            <div class="concept-box">
                <h3>ğŸ“– íŒ¨ë„ ì—°êµ¬</h3>
                <p><strong>ì •ì˜</strong>: ë™ì¼í•œ ì°¸ê°€ìë¥¼ ì—¬ëŸ¬ ì‹œì ì—ì„œ ë°˜ë³µ ì¸¡ì •</p>
                <p><strong>íŠ¹ì§•</strong>:</p>
                <ul>
                    <li>ê°œì¸ ë‚´ ë³€í™”(within-person change) ì¶”ì  ê°€ëŠ¥</li>
                    <li>ì‹œì  ê°„ ìƒê´€ê´€ê³„ ë¶„ì„ ê°€ëŠ¥</li>
                    <li>íƒˆë½(attrition) ë¬¸ì œ ë°œìƒ</li>
                </ul>
                <p><strong>ì˜ˆì‹œ</strong>: ë¬´ë¦ ê´€ì ˆì—¼ í™˜ì 100ëª…ì„ ìˆ˜ìˆ  ì „, ìˆ˜ìˆ  í›„ 3ê°œì›”, 6ê°œì›”, 12ê°œì›” ì¶”ì </p>
            </div>

            <h3>1.2 ì½”í˜¸íŠ¸ ì—°êµ¬ (Cohort Study)</h3>

            <div class="concept-box">
                <h3>ğŸ“– ì½”í˜¸íŠ¸ ì—°êµ¬</h3>
                <p><strong>ì •ì˜</strong>: íŠ¹ì • íŠ¹ì„±ì„ ê³µìœ í•˜ëŠ” ì§‘ë‹¨ì„ ì‹œê°„ì— ë”°ë¼ ì¶”ì </p>
                <p><strong>íŠ¹ì§•</strong>:</p>
                <ul>
                    <li>ë…¸ì¶œ(exposure) â†’ ê²°ê³¼(outcome) ê´€ê³„ ì—°êµ¬</li>
                    <li>ë°œìƒë¥ (incidence) ê³„ì‚° ê°€ëŠ¥</li>
                    <li>ìƒëŒ€ ìœ„í—˜ë„(relative risk) ì¶”ì • ê°€ëŠ¥</li>
                </ul>
                <p><strong>ì˜ˆì‹œ</strong>: 2020ë…„ ì…ì‚¬í•œ ë¬¼ë¦¬ì¹˜ë£Œì‚¬ë¥¼ 10ë…„ê°„ ì¶”ì í•˜ì—¬ ìš”í†µ ë°œìƒë¥  ì¡°ì‚¬</p>
            </div>

            <h3>1.3 ì¶”ì„¸ ì—°êµ¬ (Trend Study)</h3>

            <div class="concept-box">
                <h3>ğŸ“– ì¶”ì„¸ ì—°êµ¬</h3>
                <p><strong>ì •ì˜</strong>: ê°™ì€ ëª¨ì§‘ë‹¨ì—ì„œ ë‹¤ë¥¸ í‘œë³¸ì„ ì¶”ì¶œí•˜ì—¬ ë°˜ë³µ ì¡°ì‚¬</p>
                <p><strong>íŠ¹ì§•</strong>:</p>
                <ul>
                    <li>ë™ì¼ ê°œì¸ì´ ì•„ë‹Œ ë™ì¼ ëª¨ì§‘ë‹¨ ì¶”ì </li>
                    <li>ê°œì¸ ë³€í™” ì¶”ì  ë¶ˆê°€</li>
                    <li>íƒˆë½ ë¬¸ì œ ì—†ìŒ</li>
                </ul>
                <p><strong>ì˜ˆì‹œ</strong>: ë§¤ë…„ ì „êµ­ ë…¸ì¸ 1000ëª… í‘œì§‘í•˜ì—¬ ë‚™ìƒë¥  ì¡°ì‚¬ (ë‹¤ë¥¸ ë…¸ì¸)</p>
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ìœ í˜•</th>
                            <th>í‘œë³¸</th>
                            <th>ê°œì¸ ì¶”ì </th>
                            <th>íƒˆë½ ë¬¸ì œ</th>
                            <th>DB ì„¤ê³„</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>íŒ¨ë„</td>
                            <td>ë™ì¼ ê°œì¸</td>
                            <td>ê°€ëŠ¥</td>
                            <td>ìˆìŒ</td>
                            <td>Long format</td>
                        </tr>
                        <tr>
                            <td>ì½”í˜¸íŠ¸</td>
                            <td>ë™ì¼ ì§‘ë‹¨</td>
                            <td>ê°€ëŠ¥</td>
                            <td>ìˆìŒ</td>
                            <td>Long format</td>
                        </tr>
                        <tr>
                            <td>ì¶”ì„¸</td>
                            <td>ë‹¤ë¥¸ í‘œë³¸</td>
                            <td>ë¶ˆê°€</td>
                            <td>ì—†ìŒ</td>
                            <td>waveë³„ ë³„ë„</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <hr>

            <h2>2. ë°˜ë³µ ì¸¡ì • ë°ì´í„°</h2>

            <h3>2.1 ì‹œì (Time point)ì˜ ê°œë…</h3>

            <div class="concept-box">
                <h3>ğŸ“– ì‹œì  ì •ì˜ ë°©ë²•</h3>
                <p>ì¢…ë‹¨ ì—°êµ¬ì—ì„œ ì¸¡ì • ì‹œì ì„ ì •ì˜í•˜ëŠ” ë°©ë²•:</p>
                <table>
                    <thead>
                        <tr><th>ì •ì˜ ë°©ë²•</th><th>ì˜ˆì‹œ</th><th>ì í•©í•œ ìƒí™©</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ë²ˆí˜¸ (Wave)</td>
                            <td>1ì°¨, 2ì°¨, 3ì°¨</td>
                            <td>ëª¨ë“  ì°¸ê°€ìê°€ ë™ì‹œì— ì‹œì‘</td>
                        </tr>
                        <tr>
                            <td>ì‹œì  ë¼ë²¨</td>
                            <td>baseline, 3mo, 6mo</td>
                            <td>ì¤‘ì¬ ì—°êµ¬, ì¼ì •í•œ ê°„ê²©</td>
                        </tr>
                        <tr>
                            <td>ì‹¤ì œ ë‚ ì§œ</td>
                            <td>2024-01-15</td>
                            <td>ê°ì ë‹¤ë¥¸ ì‹œì ì— ì‹œì‘</td>
                        </tr>
                        <tr>
                            <td>ê²½ê³¼ ì‹œê°„</td>
                            <td>ìˆ˜ìˆ  í›„ 30ì¼</td>
                            <td>ì´ë²¤íŠ¸ ê¸°ì¤€ ì¶”ì </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>2.2 ì¸¡ì • ê°„ê²©</h3>

            <div class="example-box">
                <h3>ğŸ“ ì¸¡ì • ê°„ê²© ì˜ˆì‹œ</h3>
                <table>
                    <thead>
                        <tr><th>ì—°êµ¬ ìœ í˜•</th><th>ì¼ë°˜ì  ì¸¡ì • ì‹œì </th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ë‹¨ê¸° ì¤‘ì¬ ì—°êµ¬ (4ì£¼)</td>
                            <td>Baseline, 2ì£¼, 4ì£¼, ì¶”í›„(8ì£¼)</td>
                        </tr>
                        <tr>
                            <td>ìˆ˜ìˆ  í›„ ì¬í™œ</td>
                            <td>ìˆ˜ìˆ  ì „, 2ì£¼, 6ì£¼, 3ê°œì›”, 6ê°œì›”, 12ê°œì›”</td>
                        </tr>
                        <tr>
                            <td>ë§Œì„±ì§ˆí™˜ ì¶”ì </td>
                            <td>ë§¤ 3ê°œì›” ë˜ëŠ” ë§¤ 6ê°œì›”</td>
                        </tr>
                        <tr>
                            <td>ë…¸í™” ì—°êµ¬</td>
                            <td>ë§¤ë…„ (5~10ë…„ ì¶”ì )</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>2.3 ì‚¬ì „-ì‚¬í›„-ì¶”í›„ ì„¤ê³„</h3>

            <div class="concept-box">
                <h3>ğŸ“– ê°€ì¥ í”í•œ ì¢…ë‹¨ ì„¤ê³„</h3>
                <ul>
                    <li><strong>ì‚¬ì „(Pre-test, Baseline)</strong>: ì¤‘ì¬ ì „ ì¸¡ì •</li>
                    <li><strong>ì‚¬í›„(Post-test)</strong>: ì¤‘ì¬ ì§í›„ ì¸¡ì •</li>
                    <li><strong>ì¶”í›„(Follow-up)</strong>: ì¼ì • ê¸°ê°„ í›„ ì¸¡ì • (íš¨ê³¼ ìœ ì§€ í™•ì¸)</li>
                </ul>
            </div>

            <hr>

            <h2>3. Wide vs Long í˜•ì‹ ë¹„êµ</h2>

            <p>ì¢…ë‹¨ ë°ì´í„° ì €ì¥ì˜ ê°€ì¥ ì¤‘ìš”í•œ ê²°ì •: <strong>Wide</strong>ë¡œ ì €ì¥í•  ê²ƒì¸ê°€, <strong>Long</strong>ìœ¼ë¡œ ì €ì¥í•  ê²ƒì¸ê°€?</p>

            <h3>3.1 Wide í˜•ì‹</h3>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>participant_id</th>
                            <th>pain_t1</th>
                            <th>pain_t2</th>
                            <th>pain_t3</th>
                            <th>function_t1</th>
                            <th>function_t2</th>
                            <th>function_t3</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>P001</td><td>65</td><td>45</td><td>30</td><td>50</td><td>65</td><td>78</td></tr>
                        <tr><td>P002</td><td>70</td><td>55</td><td>NULL</td><td>45</td><td>60</td><td>NULL</td></tr>
                        <tr><td>P003</td><td>55</td><td>40</td><td>35</td><td>60</td><td>70</td><td>75</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="warning-box">
                <h3>âš ï¸ Wide í˜•ì‹ì˜ ë¬¸ì œì </h3>
                <ul>
                    <li><strong>ì»¬ëŸ¼ ìˆ˜ í­ë°œ</strong>: ì‹œì  Ã— ë³€ìˆ˜ ìˆ˜ ë§Œí¼ ì»¬ëŸ¼ í•„ìš”</li>
                    <li><strong>ìœ ì—°ì„± ë¶€ì¡±</strong>: ìƒˆ ì‹œì  ì¶”ê°€ ì‹œ í…Œì´ë¸” êµ¬ì¡° ë³€ê²½</li>
                    <li><strong>ê²°ì¸¡ ì²˜ë¦¬ ì–´ë ¤ì›€</strong>: íƒˆë½ìì˜ ë¹ˆ ì»¬ëŸ¼ë“¤</li>
                    <li><strong>ì¿¼ë¦¬ ë³µì¡</strong>: ì‹œì ë³„ ë¹„êµ ì¿¼ë¦¬ê°€ ë³µì¡í•´ì§</li>
                    <li><strong>ì‹œì  ìˆ˜ ê°€ë³€ì ì¼ ë•Œ</strong>: êµ¬ì¡°í™” ì–´ë ¤ì›€</li>
                </ul>
            </div>

            <h3>3.2 Long í˜•ì‹</h3>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>participant_id</th>
                            <th>wave</th>
                            <th>assessment_date</th>
                            <th>pain</th>
                            <th>function</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>P001</td><td>1</td><td>2024-01-15</td><td>65</td><td>50</td></tr>
                        <tr><td>P001</td><td>2</td><td>2024-04-15</td><td>45</td><td>65</td></tr>
                        <tr><td>P001</td><td>3</td><td>2024-07-15</td><td>30</td><td>78</td></tr>
                        <tr><td>P002</td><td>1</td><td>2024-01-20</td><td>70</td><td>45</td></tr>
                        <tr><td>P002</td><td>2</td><td>2024-04-20</td><td>55</td><td>60</td></tr>
                        <tr><td>P003</td><td>1</td><td>2024-02-01</td><td>55</td><td>60</td></tr>
                        <tr><td>P003</td><td>2</td><td>2024-05-01</td><td>40</td><td>70</td></tr>
                        <tr><td>P003</td><td>3</td><td>2024-08-01</td><td>35</td><td>75</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="concept-box">
                <h3>ğŸ“– Long í˜•ì‹ì˜ ì¥ì </h3>
                <ul>
                    <li><strong>ìœ ì—°ì„±</strong>: ì‹œì  ì¶”ê°€ ì‹œ í…Œì´ë¸” êµ¬ì¡° ë³€ê²½ ë¶ˆí•„ìš”</li>
                    <li><strong>ì •ê·œí™”</strong>: ë°ì´í„°ë² ì´ìŠ¤ ì •ê·œí™” ì›ì¹™ì— ë¶€í•©</li>
                    <li><strong>ìì—°ìŠ¤ëŸ¬ìš´ ê²°ì¸¡</strong>: íƒˆë½ìëŠ” í•´ë‹¹ ì‹œì  í–‰ì´ ì—†ìŒ</li>
                    <li><strong>ì¿¼ë¦¬ ìš©ì´</strong>: GROUP BYë¡œ ì‹œì ë³„ ì§‘ê³„ ì‰¬ì›€</li>
                    <li><strong>í†µê³„ ë¶„ì„</strong>: í˜¼í•©íš¨ê³¼ëª¨í˜•, GEE ë“±ì— ì í•©</li>
                </ul>
            </div>

            <h3>3.3 í˜•ì‹ ë³€í™˜</h3>

            <div class="sql-box">
                <h3>ğŸ’» Wide â†’ Long ë³€í™˜ (SQL)</h3>
                <pre><code>-- Wide í…Œì´ë¸”
CREATE TABLE wide_data (
    participant_id TEXT,
    pain_t1 INTEGER, pain_t2 INTEGER, pain_t3 INTEGER
);

-- Long í…Œì´ë¸”
CREATE TABLE long_data (
    participant_id TEXT,
    wave INTEGER,
    pain INTEGER
);

-- ë³€í™˜ (UNION ALL ì‚¬ìš©)
INSERT INTO long_data
SELECT participant_id, 1, pain_t1 FROM wide_data WHERE pain_t1 IS NOT NULL
UNION ALL
SELECT participant_id, 2, pain_t2 FROM wide_data WHERE pain_t2 IS NOT NULL
UNION ALL
SELECT participant_id, 3, pain_t3 FROM wide_data WHERE pain_t3 IS NOT NULL;</code></pre>
            </div>

            <div class="sql-box">
                <h3>ğŸ’» Long â†’ Wide ë³€í™˜ (SQL)</h3>
                <pre><code>-- Long â†’ Wide (PIVOT ë°©ì‹)
SELECT
    participant_id,
    MAX(CASE WHEN wave = 1 THEN pain END) AS pain_t1,
    MAX(CASE WHEN wave = 2 THEN pain END) AS pain_t2,
    MAX(CASE WHEN wave = 3 THEN pain END) AS pain_t3
FROM long_data
GROUP BY participant_id;</code></pre>
            </div>

            <hr>

            <h2>4. ì‹œì (Wave) ê´€ë¦¬</h2>

            <h3>4.1 Waves í…Œì´ë¸” ì„¤ê³„</h3>

            <div class="sql-box">
                <h3>ğŸ’» ì‹œì  ë©”íƒ€ë°ì´í„° í…Œì´ë¸”</h3>
                <pre><code>-- ì‹œì  ì •ì˜ í…Œì´ë¸”
CREATE TABLE waves (
    wave_id INTEGER PRIMARY KEY,
    wave_name TEXT NOT NULL,  -- 'Baseline', '3-month', '6-month'
    wave_order INTEGER NOT NULL,  -- ì •ë ¬ìš©
    target_day INTEGER,  -- ê¸°ì¤€ì¼ë¡œë¶€í„° ëª©í‘œ ì¼ìˆ˜ (0, 90, 180)
    window_before INTEGER DEFAULT 7,  -- í—ˆìš© ë²”ìœ„ (ëª©í‘œì¼ ì „ 7ì¼)
    window_after INTEGER DEFAULT 14,  -- í—ˆìš© ë²”ìœ„ (ëª©í‘œì¼ í›„ 14ì¼)
    description TEXT
);

INSERT INTO waves (wave_id, wave_name, wave_order, target_day, description) VALUES
(1, 'Baseline', 1, 0, 'ì¤‘ì¬ ì „ ê¸°ì´ˆ í‰ê°€'),
(2, '3-month', 2, 90, 'ì¤‘ì¬ í›„ 3ê°œì›”'),
(3, '6-month', 3, 180, 'ì¤‘ì¬ í›„ 6ê°œì›”'),
(4, '12-month', 4, 365, 'ì¤‘ì¬ í›„ 12ê°œì›”');</code></pre>
            </div>

            <h3>4.2 ì‹¤ì œ ì¸¡ì •ì¼ vs ëª©í‘œ ì¸¡ì •ì¼</h3>

            <div class="concept-box">
                <h3>ğŸ“– ì¸¡ì •ì¼ ê´€ë¦¬</h3>
                <p>ì‹¤ì œ ì—°êµ¬ì—ì„œëŠ” ì •í™•íˆ ëª©í‘œì¼ì— ì¸¡ì •í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤:</p>
                <ul>
                    <li><strong>ëª©í‘œ ì¸¡ì •ì¼</strong>: í”„ë¡œí† ì½œìƒ ì¸¡ì •í•´ì•¼ í•˜ëŠ” ë‚ ì§œ</li>
                    <li><strong>ì‹¤ì œ ì¸¡ì •ì¼</strong>: ì‹¤ì œë¡œ ì¸¡ì •ì´ ì´ë£¨ì–´ì§„ ë‚ ì§œ</li>
                    <li><strong>í—ˆìš© ë²”ìœ„(Window)</strong>: ëª©í‘œì¼ Â± Nì¼ ì´ë‚´ë©´ ìœ íš¨</li>
                </ul>
            </div>

            <div class="sql-box">
                <h3>ğŸ’» ì¸¡ì •ì¼ ê´€ë¦¬ ì˜ˆì‹œ</h3>
                <pre><code>-- í‰ê°€ í…Œì´ë¸”
CREATE TABLE assessments (
    assessment_id INTEGER PRIMARY KEY,
    participant_id TEXT NOT NULL,
    wave_id INTEGER NOT NULL,
    target_date DATE,  -- ëª©í‘œ ì¸¡ì •ì¼
    actual_date DATE,  -- ì‹¤ì œ ì¸¡ì •ì¼
    days_from_baseline INTEGER,  -- ê¸°ì¤€ì¼ë¡œë¶€í„° ì‹¤ì œ ê²½ê³¼ì¼
    within_window INTEGER,  -- í—ˆìš© ë²”ìœ„ ë‚´ ì—¬ë¶€ (0/1)

    -- ì¸¡ì • ë³€ìˆ˜ë“¤
    pain_vas INTEGER,
    function_score INTEGER,

    FOREIGN KEY (participant_id) REFERENCES participants(participant_id),
    FOREIGN KEY (wave_id) REFERENCES waves(wave_id)
);

-- ëª©í‘œì¼ ê³„ì‚° (Baseline ë‚ ì§œ + ëª©í‘œ ì¼ìˆ˜)
-- í—ˆìš© ë²”ìœ„ í™•ì¸
SELECT
    a.participant_id,
    a.wave_id,
    w.wave_name,
    a.target_date,
    a.actual_date,
    julianday(a.actual_date) - julianday(a.target_date) AS deviation_days,
    CASE
        WHEN julianday(a.actual_date) BETWEEN
             julianday(a.target_date) - w.window_before AND
             julianday(a.target_date) + w.window_after
        THEN 'Within window'
        ELSE 'Out of window'
    END AS window_status
FROM assessments a
JOIN waves w ON a.wave_id = w.wave_id;</code></pre>
            </div>

            <hr>

            <h2>5. íƒˆë½(Attrition) ì²˜ë¦¬</h2>

            <h3>5.1 íƒˆë½ì´ë€?</h3>

            <div class="concept-box">
                <h3>ğŸ“– íƒˆë½(Attrition)</h3>
                <p>ì¢…ë‹¨ ì—°êµ¬ì—ì„œ ì°¸ê°€ìê°€ ì¶”ì ê´€ì°°ì—ì„œ ë¹ ì§€ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>
                <p><strong>íƒˆë½ ìœ í˜•</strong>:</p>
                <ul>
                    <li><strong>ì™„ì „ íƒˆë½</strong>: íŠ¹ì • ì‹œì  ì´í›„ ëª¨ë“  í‰ê°€ ëˆ„ë½</li>
                    <li><strong>ê°„í—ì  ê²°ì¸¡</strong>: ì¼ë¶€ ì‹œì ë§Œ ëˆ„ë½ (ì¤‘ê°„ì— ë³µê·€)</li>
                </ul>
                <p><strong>íƒˆë½ ì‚¬ìœ </strong>:</p>
                <ul>
                    <li>ì—°ë½ ë‘ì ˆ, ì´ì‚¬</li>
                    <li>ì°¸ì—¬ ê±°ë¶€, ì‹œê°„ ë¶€ì¡±</li>
                    <li>ì‚¬ë§, ì‹¬ê°í•œ ì§ˆë³‘</li>
                    <li>ë¶€ì‘ìš©, ì¤‘ì¬ ë¶€ì í•©</li>
                </ul>
            </div>

            <h3>5.2 íƒˆë½ë¥  ê³„ì‚°</h3>

            <div class="sql-box">
                <h3>ğŸ’» ì‹œì ë³„ íƒˆë½ë¥  ê³„ì‚°</h3>
                <pre><code>-- ê° ì‹œì ë³„ ì‘ë‹µì ìˆ˜ì™€ íƒˆë½ë¥ 
WITH baseline_n AS (
    SELECT COUNT(DISTINCT participant_id) AS n_baseline
    FROM assessments WHERE wave_id = 1
)
SELECT
    w.wave_name,
    COUNT(DISTINCT a.participant_id) AS n_completed,
    b.n_baseline,
    ROUND(100.0 * COUNT(DISTINCT a.participant_id) / b.n_baseline, 1) AS retention_rate,
    ROUND(100.0 * (1 - COUNT(DISTINCT a.participant_id) * 1.0 / b.n_baseline), 1) AS attrition_rate
FROM waves w
LEFT JOIN assessments a ON w.wave_id = a.wave_id
CROSS JOIN baseline_n b
GROUP BY w.wave_id, w.wave_name, w.wave_order, b.n_baseline
ORDER BY w.wave_order;</code></pre>
            </div>

            <h3>5.3 íƒˆë½ ì‚¬ìœ  ê¸°ë¡</h3>

            <div class="sql-box">
                <h3>ğŸ’» íƒˆë½ ì •ë³´ í…Œì´ë¸”</h3>
                <pre><code>-- íƒˆë½ ì‚¬ìœ  ì½”ë“œ
CREATE TABLE dropout_reasons (
    reason_code TEXT PRIMARY KEY,
    reason_description TEXT
);

INSERT INTO dropout_reasons VALUES
('LOST', 'ì—°ë½ ë‘ì ˆ'),
('REFUSE', 'ì°¸ì—¬ ê±°ë¶€'),
('DEATH', 'ì‚¬ë§'),
('ILLNESS', 'ì‹¬ê°í•œ ì§ˆë³‘'),
('MOVED', 'ì´ì‚¬/ì´ë™'),
('ADVERSE', 'ë¶€ì‘ìš©'),
('COMPLETE', 'ì—°êµ¬ ì¢…ë£Œ (ì •ìƒ)'),
('OTHER', 'ê¸°íƒ€');

-- ì°¸ê°€ì ìƒíƒœ í…Œì´ë¸”
CREATE TABLE participant_status (
    participant_id TEXT PRIMARY KEY,
    enrollment_date DATE NOT NULL,
    status TEXT DEFAULT 'ACTIVE',  -- 'ACTIVE', 'DROPPED', 'COMPLETED'
    dropout_date DATE,
    dropout_wave_id INTEGER,  -- ë§ˆì§€ë§‰ ì°¸ì—¬ ì‹œì 
    dropout_reason_code TEXT,
    dropout_notes TEXT,
    FOREIGN KEY (participant_id) REFERENCES participants(participant_id),
    FOREIGN KEY (dropout_reason_code) REFERENCES dropout_reasons(reason_code)
);

-- íƒˆë½ ì‚¬ìœ ë³„ ì§‘ê³„
SELECT
    dr.reason_description,
    COUNT(*) AS n,
    ROUND(100.0 * COUNT(*) / (SELECT COUNT(*) FROM participant_status WHERE status = 'DROPPED'), 1) AS pct
FROM participant_status ps
JOIN dropout_reasons dr ON ps.dropout_reason_code = dr.reason_code
WHERE ps.status = 'DROPPED'
GROUP BY dr.reason_description
ORDER BY n DESC;</code></pre>
            </div>

            <h3>5.4 ì„ íƒì  íƒˆë½ì˜ ë¬¸ì œ</h3>

            <div class="warning-box">
                <h3>âš ï¸ ì„ íƒì  íƒˆë½(Selective Attrition)</h3>
                <p>íƒˆë½ì´ ë¬´ì‘ìœ„ê°€ ì•„ë‹ˆë¼ íŠ¹ì • íŠ¹ì„±ê³¼ ê´€ë ¨ë  ë•Œ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤:</p>
                <ul>
                    <li><strong>ì˜ˆì‹œ</strong>: ì¤‘ì¬ íš¨ê³¼ê°€ ì—†ëŠ” ì‚¬ëŒì´ ë” ë§ì´ íƒˆë½</li>
                    <li><strong>ê²°ê³¼</strong>: ë‚¨ì€ ì‚¬ëŒë“¤ë§Œ ë¶„ì„í•˜ë©´ íš¨ê³¼ê°€ ê³¼ëŒ€í‰ê°€ë¨</li>
                    <li><strong>ê²€í† </strong>: íƒˆë½ì vs ì™„ë£Œìì˜ baseline íŠ¹ì„± ë¹„êµ</li>
                </ul>
            </div>

            <div class="sql-box">
                <h3>ğŸ’» ì„ íƒì  íƒˆë½ ê²€í† </h3>
                <pre><code>-- íƒˆë½ì vs ì™„ë£Œì baseline ë¹„êµ
SELECT
    CASE
        WHEN ps.status = 'DROPPED' THEN 'íƒˆë½'
        ELSE 'ì™„ë£Œ'
    END AS group_status,
    COUNT(*) AS n,
    ROUND(AVG(a.pain_vas), 1) AS baseline_pain,
    ROUND(AVG(a.function_score), 1) AS baseline_function,
    ROUND(AVG(p.age), 1) AS mean_age
FROM participants p
JOIN participant_status ps ON p.participant_id = ps.participant_id
JOIN assessments a ON p.participant_id = a.participant_id AND a.wave_id = 1
GROUP BY CASE WHEN ps.status = 'DROPPED' THEN 'íƒˆë½' ELSE 'ì™„ë£Œ' END;

-- íƒˆë½ìê°€ baselineì—ì„œ í†µì¦ì´ ë” ë†’ì•˜ë‹¤ë©´ ì„ íƒì  íƒˆë½ ì˜ì‹¬</code></pre>
            </div>

            <hr>

            <h2>6. ì¢…ë‹¨ ì—°êµ¬ DB ì„¤ê³„ ì˜ˆì‹œ</h2>

            <h3>6.1 ì™„ì „í•œ ìŠ¤í‚¤ë§ˆ</h3>

            <div class="sql-box">
                <h3>ğŸ’» ë¬´ë¦ ê´€ì ˆì—¼ ì¬í™œ ì¢…ë‹¨ ì—°êµ¬</h3>
                <pre><code>-- ì—°êµ¬: ë¬´ë¦ ì¸ê³µê´€ì ˆ ìˆ˜ìˆ  í›„ 12ê°œì›” ì¶”ì 
-- ì‹œì : ìˆ˜ìˆ  ì „, 2ì£¼, 6ì£¼, 3ê°œì›”, 6ê°œì›”, 12ê°œì›”

-- 1. ì°¸ê°€ì ê¸°ë³¸ ì •ë³´
CREATE TABLE knee_study_participants (
    participant_id TEXT PRIMARY KEY,
    enrollment_date DATE NOT NULL,
    surgery_date DATE,

    -- ì¸êµ¬í†µê³„
    birth_date DATE,
    gender TEXT CHECK (gender IN ('M', 'F')),

    -- ìˆ˜ìˆ  ì •ë³´
    surgery_type TEXT,  -- 'TKA_right', 'TKA_left', 'TKA_bilateral'
    surgeon_id TEXT,
    hospital_id TEXT
);

-- 2. ì‹œì  ì •ì˜
CREATE TABLE knee_study_waves (
    wave_id INTEGER PRIMARY KEY,
    wave_name TEXT NOT NULL,
    wave_order INTEGER NOT NULL,
    target_day INTEGER,  -- ìˆ˜ìˆ ì¼ ê¸°ì¤€ ê²½ê³¼ì¼
    window_before INTEGER DEFAULT 7,
    window_after INTEGER DEFAULT 14
);

INSERT INTO knee_study_waves VALUES
(1, 'Pre-op', 1, -14, 14, 0),       -- ìˆ˜ìˆ  2ì£¼ ì „ ~ ìˆ˜ìˆ  ì „
(2, '2-week', 2, 14, 3, 7),         -- ìˆ˜ìˆ  í›„ 11-21ì¼
(3, '6-week', 3, 42, 7, 14),        -- ìˆ˜ìˆ  í›„ 35-56ì¼
(4, '3-month', 4, 90, 14, 21),      -- ìˆ˜ìˆ  í›„ 76-111ì¼
(5, '6-month', 5, 180, 14, 28),     -- ìˆ˜ìˆ  í›„ 166-208ì¼
(6, '12-month', 6, 365, 21, 42);    -- ìˆ˜ìˆ  í›„ 344-407ì¼

-- 3. í‰ê°€ ë°ì´í„° (Long format)
CREATE TABLE knee_study_assessments (
    assessment_id INTEGER PRIMARY KEY,
    participant_id TEXT NOT NULL,
    wave_id INTEGER NOT NULL,
    assessment_date DATE NOT NULL,
    assessor_id TEXT,

    -- ê³„ì‚°ëœ í•„ë“œ
    days_post_surgery INTEGER,  -- ìˆ˜ìˆ  í›„ ê²½ê³¼ì¼

    -- í†µì¦ (VAS 0-100)
    pain_rest INTEGER CHECK (pain_rest BETWEEN 0 AND 100),
    pain_walking INTEGER CHECK (pain_walking BETWEEN 0 AND 100),
    pain_stairs INTEGER CHECK (pain_stairs BETWEEN 0 AND 100),

    -- ê´€ì ˆê°€ë™ë²”ìœ„
    rom_flexion INTEGER,
    rom_extension INTEGER,

    -- ê·¼ë ¥ (ë„ìˆ˜ê·¼ë ¥ê²€ì‚¬ ë˜ëŠ” ë™ë ¥ê³„)
    quad_strength DECIMAL(4,1),  -- kg or grade
    hamstring_strength DECIMAL(4,1),

    -- ê¸°ëŠ¥ (WOMAC, 0-96ì , ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ)
    womac_pain INTEGER,      -- 0-20
    womac_stiffness INTEGER, -- 0-8
    womac_function INTEGER,  -- 0-68
    womac_total INTEGER,     -- 0-96

    -- ë³´í–‰
    tug_time_sec DECIMAL(5,2),
    gait_speed_ms DECIMAL(4,2),

    FOREIGN KEY (participant_id) REFERENCES knee_study_participants(participant_id),
    FOREIGN KEY (wave_id) REFERENCES knee_study_waves(wave_id)
);

-- 4. ì°¸ê°€ì ìƒíƒœ ì¶”ì 
CREATE TABLE knee_study_status (
    participant_id TEXT PRIMARY KEY,
    current_status TEXT DEFAULT 'ACTIVE',
    last_completed_wave INTEGER,
    dropout_date DATE,
    dropout_reason TEXT,
    FOREIGN KEY (participant_id) REFERENCES knee_study_participants(participant_id)
);

-- 5. í†µí•© ì¡°íšŒ VIEW
CREATE VIEW knee_study_complete AS
SELECT
    p.participant_id,
    (julianday(p.surgery_date) - julianday(p.birth_date)) / 365.25 AS age_at_surgery,
    p.gender,
    p.surgery_type,
    w.wave_name,
    w.wave_order,
    a.assessment_date,
    a.days_post_surgery,
    a.pain_rest,
    a.pain_walking,
    a.rom_flexion,
    a.rom_extension,
    a.womac_total,
    a.tug_time_sec,
    s.current_status
FROM knee_study_participants p
JOIN knee_study_assessments a ON p.participant_id = a.participant_id
JOIN knee_study_waves w ON a.wave_id = w.wave_id
LEFT JOIN knee_study_status s ON p.participant_id = s.participant_id;</code></pre>
            </div>

            <h3>6.2 ë¶„ì„ ì¿¼ë¦¬</h3>

            <div class="sql-box">
                <h3>ğŸ’» ì¢…ë‹¨ ë¶„ì„ ì¿¼ë¦¬</h3>
                <pre><code>-- 1. ì‹œì ë³„ ê¸°ìˆ í†µê³„
SELECT
    wave_name,
    COUNT(*) AS n,
    ROUND(AVG(pain_rest), 1) AS mean_pain,
    ROUND(AVG(rom_flexion), 1) AS mean_flexion,
    ROUND(AVG(womac_total), 1) AS mean_womac,
    ROUND(AVG(tug_time_sec), 2) AS mean_tug
FROM knee_study_complete
GROUP BY wave_name, wave_order
ORDER BY wave_order;

-- 2. ê°œì¸ë³„ ë³€í™”ëŸ‰ ê³„ì‚° (Pre-op vs 6-month)
WITH pre_op AS (
    SELECT participant_id, pain_rest AS pain_pre, womac_total AS womac_pre
    FROM knee_study_complete WHERE wave_name = 'Pre-op'
),
six_month AS (
    SELECT participant_id, pain_rest AS pain_6mo, womac_total AS womac_6mo
    FROM knee_study_complete WHERE wave_name = '6-month'
)
SELECT
    pre.participant_id,
    pre.pain_pre,
    six.pain_6mo,
    pre.pain_pre - six.pain_6mo AS pain_change,
    pre.womac_pre,
    six.womac_6mo,
    pre.womac_pre - six.womac_6mo AS womac_change
FROM pre_op pre
JOIN six_month six ON pre.participant_id = six.participant_id;

-- 3. ì‹œì ë³„ íƒˆë½ë¥ 
WITH baseline_n AS (
    SELECT COUNT(DISTINCT participant_id) AS n FROM knee_study_complete WHERE wave_name = 'Pre-op'
)
SELECT
    wave_name,
    wave_order,
    COUNT(*) AS n_assessed,
    (SELECT n FROM baseline_n) AS n_baseline,
    ROUND(100.0 * COUNT(*) / (SELECT n FROM baseline_n), 1) AS retention_pct
FROM knee_study_complete
GROUP BY wave_name, wave_order
ORDER BY wave_order;

-- 4. í†µê³„ ë¶„ì„ìš© Long format ë°ì´í„° ì¶”ì¶œ
SELECT
    participant_id,
    wave_order AS time,
    days_post_surgery,
    pain_rest,
    womac_total,
    rom_flexion
FROM knee_study_complete
ORDER BY participant_id, wave_order;</code></pre>
            </div>

            <div class="summary-box">
                <h3>ğŸ“ ì´ ì¥ì˜ í•µì‹¬ ì •ë¦¬</h3>
                <ol>
                    <li><strong>ì¢…ë‹¨ ì—°êµ¬ ìœ í˜•</strong>: íŒ¨ë„(ë™ì¼ ê°œì¸), ì½”í˜¸íŠ¸(íŠ¹ì • ì§‘ë‹¨), ì¶”ì„¸(ë‹¤ë¥¸ í‘œë³¸)</li>
                    <li><strong>ë°˜ë³µ ì¸¡ì •</strong>: ì‹œì (wave)ì„ ëª…í™•íˆ ì •ì˜í•˜ê³  ê´€ë¦¬</li>
                    <li><strong>Long format ê¶Œì¥</strong>: ìœ ì—°ì„±, ì •ê·œí™”, í†µê³„ ë¶„ì„ì— ìœ ë¦¬</li>
                    <li><strong>ì‹œì  ê´€ë¦¬</strong>: waves í…Œì´ë¸”ë¡œ ì‹œì  ë©”íƒ€ë°ì´í„° ê´€ë¦¬</li>
                    <li><strong>íƒˆë½ ì²˜ë¦¬</strong>: íƒˆë½ë¥ , íƒˆë½ ì‚¬ìœ , ì„ íƒì  íƒˆë½ ê²€í† </li>
                    <li><strong>ì„¤ê³„ íŒ¨í„´</strong>: participants + waves + assessments êµ¬ì¡°</li>
                </ol>
            </div>

            <div class="nav-buttons">
                <a href="chapter-10.html" class="nav-btn">â† ì´ì „</a>
                <span class="page-num">11 / 20</span>
                <a href="chapter-12.html" class="nav-btn">ë‹¤ìŒ â†’</a>
            </div>
        </main>
    </div>
    <script src="../js/nav.js"></script>
</body>
</html>
