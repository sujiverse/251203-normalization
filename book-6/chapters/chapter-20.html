<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[20ì¥] ë¶„ì„ ë„êµ¬ ì—°ë™ - ì—°êµ¬ ë°ì´í„° ì„¤ê³„</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <nav class="top-nav">
        <a href="../../index.html" class="top-nav-brand"><span>ğŸ“Š</span> ì—°êµ¬ ë°ì´í„° ì„¤ê³„</a>
        <div class="top-nav-links">
            <a href="../../book-1/index.html" class="top-nav-link book-1">1ê¶Œ</a>
            <a href="../../book-2/index.html" class="top-nav-link book-2">2ê¶Œ</a>
            <a href="../../book-3/index.html" class="top-nav-link book-3">3ê¶Œ</a>
            <a href="../../book-4/index.html" class="top-nav-link book-4">4ê¶Œ</a>
            <a href="../../book-5/index.html" class="top-nav-link book-5">5ê¶Œ</a>
            <a href="../../book-6/index.html" class="top-nav-link book-6 active">6ê¶Œ</a>
        </div>
    </nav>
    <button class="menu-toggle" onclick="toggleMenu()">â˜°</button>
    <div class="overlay" id="overlay" onclick="toggleMenu()"></div>
    <div class="container">
        <nav class="sidebar" id="sidebar">
            <button class="close-btn" onclick="toggleMenu()">Ã—</button>
            <div class="sidebar-header"><h1>ğŸ“˜ 6ê¶Œ: ì—°êµ¬ ë°ì´í„° ì„¤ê³„</h1><p>ë³€ìˆ˜ë¶€í„° íšŒê·€ë¶„ì„ê¹Œì§€</p></div>
            <ul class="nav-list" id="navList"></ul>
        </nav>
        <main class="main">
            <div class="part-header">5ë¶€: ì‹¤ë¬´ ë°ì´í„° ê´€ë¦¬</div>
            <h1 class="title">[20ì¥] ë¶„ì„ ë„êµ¬ ì—°ë™</h1>

            <div class="intro-box">
                <p>ì´ ì¥ì—ì„œëŠ” ì„¤ê³„í•œ DBë¥¼ <strong>SPSS, R, Python, Excel</strong> ë“± ì‹¤ì œ ë¶„ì„ ë„êµ¬ì™€ ì—°ë™í•˜ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.</p>
            </div>

            <hr>

            <h2>1. ë°ì´í„° ë‚´ë³´ë‚´ê¸° í˜•ì‹</h2>

            <h3>1.1 ì£¼ìš” ë°ì´í„° í˜•ì‹ ë¹„êµ</h3>

            <div class="table-container">
                <table>
                    <tr><th>í˜•ì‹</th><th>í™•ì¥ì</th><th>ì¥ì </th><th>ë‹¨ì </th><th>ìš©ë„</th></tr>
                    <tr>
                        <td>CSV</td>
                        <td>.csv</td>
                        <td>ë²”ìš©, ëª¨ë“  ë„êµ¬ í˜¸í™˜</td>
                        <td>ë©”íƒ€ë°ì´í„° ì—†ìŒ, ì¸ì½”ë”© ë¬¸ì œ</td>
                        <td>ë°ì´í„° êµí™˜ í‘œì¤€</td>
                    </tr>
                    <tr>
                        <td>TSV</td>
                        <td>.tsv, .txt</td>
                        <td>ì‰¼í‘œ í¬í•¨ ë°ì´í„° ì•ˆì „</td>
                        <td>ë©”íƒ€ë°ì´í„° ì—†ìŒ</td>
                        <td>í…ìŠ¤íŠ¸ ë°ì´í„°</td>
                    </tr>
                    <tr>
                        <td>Excel</td>
                        <td>.xlsx</td>
                        <td>ì„œì‹ ìœ ì§€, ì‹œíŠ¸ êµ¬ë¶„</td>
                        <td>ëŒ€ìš©ëŸ‰ ë¶ˆë¦¬, ì˜¤ë˜ëœ ë²„ì „ í˜¸í™˜</td>
                        <td>ë³´ê³ ì„œ, ê³µìœ </td>
                    </tr>
                    <tr>
                        <td>SPSS</td>
                        <td>.sav</td>
                        <td>ë³€ìˆ˜/ê°’ ë ˆì´ë¸” í¬í•¨</td>
                        <td>SPSS ì „ìš©</td>
                        <td>í†µê³„ ë¶„ì„</td>
                    </tr>
                    <tr>
                        <td>SQLite</td>
                        <td>.db, .sqlite</td>
                        <td>ê´€ê³„í˜•, ì¿¼ë¦¬ ê°€ëŠ¥</td>
                        <td>ë³„ë„ ë„êµ¬ í•„ìš”</td>
                        <td>ë°ì´í„° ì €ì¥/ê´€ë¦¬</td>
                    </tr>
                </table>
            </div>

            <h3>1.2 SQLiteì—ì„œ CSV ë‚´ë³´ë‚´ê¸°</h3>

            <div class="sql-box">
                <h3>â–¶ DB Browser for SQLiteì—ì„œ CSV ë‚´ë³´ë‚´ê¸°</h3>
                <pre><code>-- 1. ì›í•˜ëŠ” ë°ì´í„°ë¥¼ SELECT ì¿¼ë¦¬ë¡œ ì¤€ë¹„
SELECT
    p.participant_id,
    p.age,
    p.sex,
    p.group_id,
    p.vas_pre,
    p.vas_post,
    p.berg_pre,
    p.berg_post
FROM participants p
WHERE p.vas_pre IS NOT NULL;

-- 2. DB Browserì—ì„œ: File â†’ Export â†’ Table(s) as CSV file
-- ë˜ëŠ”: ì¿¼ë¦¬ ê²°ê³¼ ìš°í´ë¦­ â†’ Export to CSV

-- 3. ëª…ë ¹ì¤„ì—ì„œ ë‚´ë³´ë‚´ê¸° (sqlite3)
-- sqlite3 -header -csv research.db "SELECT * FROM participants;" > data.csv</code></pre>
            </div>

            <h3>1.3 ì¸ì½”ë”© ì£¼ì˜ì‚¬í•­</h3>

            <div class="warning-box">
                <h3>âš ï¸ í•œê¸€ ì¸ì½”ë”© ë¬¸ì œ</h3>
                <ul>
                    <li><strong>UTF-8</strong>: êµ­ì œ í‘œì¤€, R/Python ê¶Œì¥</li>
                    <li><strong>UTF-8 with BOM</strong>: Excelì—ì„œ í•œê¸€ ê¹¨ì§ ë°©ì§€</li>
                    <li><strong>EUC-KR (CP949)</strong>: êµ¬í˜• í•œê¸€ Windows í”„ë¡œê·¸ë¨</li>
                </ul>
                <p>Excelì—ì„œ CSVë¥¼ ì—´ ë•Œ í•œê¸€ì´ ê¹¨ì§€ë©´: ë°ì´í„° â†’ í…ìŠ¤íŠ¸ì—ì„œ ê°€ì ¸ì˜¤ê¸° â†’ ì¸ì½”ë”© UTF-8 ì„ íƒ</p>
            </div>

            <hr>

            <h2>2. SPSS ì—°ë™</h2>

            <h3>2.1 ODBCë¥¼ í†µí•œ SQLite ì—°ê²°</h3>

            <div class="concept-box">
                <h3>ğŸ“‹ ODBCë€?</h3>
                <p><strong>ODBC(Open Database Connectivity)</strong>ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì´ ë‹¤ì–‘í•œ ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í‘œì¤€ ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤. SPSS, Excel ë“±ì—ì„œ SQLite DBì— ì§ì ‘ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>

            <div class="example-box">
                <h3>ğŸ’¡ SPSSì—ì„œ SQLite ì—°ê²° ë‹¨ê³„</h3>
                <ol>
                    <li>SQLite ODBC ë“œë¼ì´ë²„ ì„¤ì¹˜ (sqliteodbc.org)</li>
                    <li>Windows ODBC ë°ì´í„° ì›ë³¸ ê´€ë¦¬ìì—ì„œ DSN ìƒì„±</li>
                    <li>SPSS: íŒŒì¼ â†’ ë°ì´í„°ë² ì´ìŠ¤ ì—´ê¸° â†’ ìƒˆ ì¿¼ë¦¬</li>
                    <li>ìƒì„±í•œ DSN ì„ íƒ í›„ ì¿¼ë¦¬ ì‘ì„±</li>
                </ol>
            </div>

            <h3>2.2 SPSS êµ¬ë¬¸(Syntax)ìœ¼ë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</h3>

            <div class="sql-box">
                <h3>â–¶ SPSS Syntax: CSV íŒŒì¼ ì½ê¸°</h3>
                <pre><code>* SPSS Syntax: CSV íŒŒì¼ ì½ê¸°.
GET DATA
  /TYPE=TXT
  /FILE="C:\ì—°êµ¬ë°ì´í„°\balance_study.csv"
  /ENCODING='UTF8'
  /DELCASE=LINE
  /DELIMITERS=","
  /QUALIFIER='"'
  /ARRANGEMENT=DELIMITED
  /FIRSTCASE=2
  /VARIABLES=
    participant_id A10
    age F3.0
    sex F1.0
    group_id F1.0
    vas_pre F3.0
    vas_post F3.0
    berg_pre F2.0
    berg_post F2.0.
EXECUTE.</code></pre>
            </div>

            <h3>2.3 SPSSì—ì„œ ë³€ìˆ˜/ê°’ ë ˆì´ë¸” ì„¤ì •</h3>

            <div class="sql-box">
                <h3>â–¶ SPSS Syntax: ë³€ìˆ˜ ë ˆì´ë¸” ì •ì˜</h3>
                <pre><code>* ë³€ìˆ˜ ë ˆì´ë¸” ì •ì˜.
VARIABLE LABELS
    participant_id 'ì°¸ê°€ì ID'
    age 'ë‚˜ì´(ì„¸)'
    sex 'ì„±ë³„'
    group_id 'ì§‘ë‹¨'
    vas_pre 'ì‚¬ì „ VAS ì ìˆ˜'
    vas_post 'ì‚¬í›„ VAS ì ìˆ˜'
    berg_pre 'ì‚¬ì „ BBS ì ìˆ˜'
    berg_post 'ì‚¬í›„ BBS ì ìˆ˜'.

* ê°’ ë ˆì´ë¸” ì •ì˜.
VALUE LABELS
    sex
        1 'ë‚¨ì„±'
        2 'ì—¬ì„±'
    /group_id
        1 'ì‹¤í—˜êµ°-A (ê· í˜•í›ˆë ¨)'
        2 'ì‹¤í—˜êµ°-B (ê·¼ë ¥í›ˆë ¨)'
        3 'ëŒ€ì¡°êµ°'.

* ì¸¡ì • ìˆ˜ì¤€ ì§€ì •.
VARIABLE LEVEL
    age vas_pre vas_post (SCALE)
    berg_pre berg_post (ORDINAL)
    sex group_id (NOMINAL).

* ê²°ì¸¡ê°’ ì •ì˜.
MISSING VALUES
    vas_pre vas_post berg_pre berg_post (-9, -99).</code></pre>
            </div>

            <h3>2.4 ì½”ë“œë¶ì—ì„œ SPSS êµ¬ë¬¸ ìë™ ìƒì„±</h3>

            <div class="sql-box">
                <h3>â–¶ SQLë¡œ SPSS ë³€ìˆ˜ ë ˆì´ë¸” êµ¬ë¬¸ ìƒì„±</h3>
                <pre><code>-- SPSS VARIABLE LABELS êµ¬ë¬¸ ìƒì„±
SELECT
    'VARIABLE LABELS' AS syntax
UNION ALL
SELECT
    '    ' || variable_name || ' ''' || variable_label || ''''
    || CASE
        WHEN position = (SELECT MAX(position) FROM data_dictionary WHERE dataset_id = 1)
        THEN '.'
        ELSE ''
    END
FROM data_dictionary
WHERE dataset_id = 1
ORDER BY position;

/* ì¶œë ¥:
VARIABLE LABELS
    participant_id 'ì°¸ê°€ì ID'
    age 'ë‚˜ì´'
    sex 'ì„±ë³„'
    ...
*/

-- SPSS VALUE LABELS êµ¬ë¬¸ ìƒì„±
SELECT
    'VALUE LABELS' AS line_text
UNION ALL
SELECT
    '    ' || dd.variable_name || CHAR(10) ||
    GROUP_CONCAT('        ' || vl.code_value || ' ''' || vl.label || '''', CHAR(10))
FROM data_dictionary dd
JOIN value_labels vl ON dd.variable_id = vl.variable_id
WHERE dd.dataset_id = 1
GROUP BY dd.variable_id;</code></pre>
            </div>

            <hr>

            <h2>3. R ì—°ë™</h2>

            <h3>3.1 Rì—ì„œ SQLite ì—°ê²°</h3>

            <div class="concept-box">
                <h3>ğŸ“‹ í•„ìš”í•œ R íŒ¨í‚¤ì§€</h3>
                <ul>
                    <li><strong>DBI</strong>: ë°ì´í„°ë² ì´ìŠ¤ ì¸í„°í˜ì´ìŠ¤ í‘œì¤€</li>
                    <li><strong>RSQLite</strong>: SQLite ì „ìš© ë“œë¼ì´ë²„</li>
                    <li><strong>dplyr/dbplyr</strong>: tidyverse ìŠ¤íƒ€ì¼ DB ì¿¼ë¦¬</li>
                </ul>
            </div>

            <div class="sql-box">
                <h3>â–¶ R ì½”ë“œ: SQLite ì—°ê²° ë° ì¿¼ë¦¬</h3>
                <pre><code># íŒ¨í‚¤ì§€ ì„¤ì¹˜ (ìµœì´ˆ 1íšŒ)
install.packages(c("DBI", "RSQLite", "dplyr", "dbplyr"))

# íŒ¨í‚¤ì§€ ë¡œë“œ
library(DBI)
library(RSQLite)
library(dplyr)

# SQLite ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
con <- dbConnect(RSQLite::SQLite(), "research.db")

# í…Œì´ë¸” ëª©ë¡ í™•ì¸
dbListTables(con)

# SQL ì¿¼ë¦¬ë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
participants <- dbGetQuery(con, "
    SELECT *
    FROM participants
    WHERE vas_pre IS NOT NULL
")

# ê²°ê³¼ í™•ì¸
head(participants)
str(participants)</code></pre>
            </div>

            <h3>3.2 dplyrì„ ì´ìš©í•œ DB ì¿¼ë¦¬</h3>

            <div class="sql-box">
                <h3>â–¶ R ì½”ë“œ: dplyr íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ DB ì¿¼ë¦¬</h3>
                <pre><code># í…Œì´ë¸”ì„ dplyr í…Œì´ë¸”ë¡œ ì°¸ì¡°
tbl_participants <- tbl(con, "participants")

# dplyr ë¬¸ë²•ìœ¼ë¡œ ì¿¼ë¦¬ (ì‹¤ì œ SQLë¡œ ë³€í™˜ë¨)
result <- tbl_participants %>%
    filter(!is.na(vas_pre)) %>%
    group_by(group_id) %>%
    summarise(
        n = n(),
        mean_age = mean(age, na.rm = TRUE),
        mean_vas_pre = mean(vas_pre, na.rm = TRUE),
        mean_vas_post = mean(vas_post, na.rm = TRUE)
    ) %>%
    collect()  # DBì—ì„œ Rë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°

print(result)

# ìƒì„±ëœ SQL í™•ì¸
tbl_participants %>%
    filter(!is.na(vas_pre)) %>%
    group_by(group_id) %>%
    summarise(mean_vas = mean(vas_pre)) %>%
    show_query()</code></pre>
            </div>

            <h3>3.3 ë¶„ì„ ê²°ê³¼ë¥¼ DBì— ì €ì¥</h3>

            <div class="sql-box">
                <h3>â–¶ R ì½”ë“œ: ë¶„ì„ ê²°ê³¼ DBì— ì €ì¥</h3>
                <pre><code># t-ê²€ì • ì‹¤í–‰
t_result <- t.test(
    vas_post ~ group_id,
    data = participants %>% filter(group_id %in% c(1, 3))
)

# ê²°ê³¼ë¥¼ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ì •ë¦¬
analysis_result <- data.frame(
    analysis_id = 1,
    analysis_type = "independent_t_test",
    dependent_var = "vas_post",
    grouping_var = "group_id",
    groups_compared = "1 vs 3",
    t_statistic = t_result$statistic,
    df = t_result$parameter,
    p_value = t_result$p.value,
    mean_group1 = t_result$estimate[1],
    mean_group2 = t_result$estimate[2],
    analysis_date = Sys.time()
)

# ê²°ê³¼ í…Œì´ë¸”ì— ì €ì¥
dbWriteTable(con, "analysis_results", analysis_result,
             append = TRUE, row.names = FALSE)

# ì €ì¥ í™•ì¸
dbGetQuery(con, "SELECT * FROM analysis_results")</code></pre>
            </div>

            <h3>3.4 Rì—ì„œ ê°’ ë ˆì´ë¸” ì ìš©</h3>

            <div class="sql-box">
                <h3>â–¶ R ì½”ë“œ: factorë¡œ ê°’ ë ˆì´ë¸” ì ìš©</h3>
                <pre><code># ê°’ ë ˆì´ë¸”ì„ DBì—ì„œ ê°€ì ¸ì˜¤ê¸°
sex_labels <- dbGetQuery(con, "
    SELECT code_value, label
    FROM value_labels vl
    JOIN data_dictionary dd ON vl.variable_id = dd.variable_id
    WHERE dd.variable_name = 'sex'
    ORDER BY display_order
")

group_labels <- dbGetQuery(con, "
    SELECT code_value, label
    FROM value_labels vl
    JOIN data_dictionary dd ON vl.variable_id = dd.variable_id
    WHERE dd.variable_name = 'group'
    ORDER BY display_order
")

# factor ë³€í™˜ (ë ˆì´ë¸” ì ìš©)
participants$sex <- factor(
    participants$sex,
    levels = sex_labels$code_value,
    labels = sex_labels$label
)

participants$group_id <- factor(
    participants$group_id,
    levels = group_labels$code_value,
    labels = group_labels$label
)

# í™•ì¸
table(participants$sex)
table(participants$group_id)

# ì—°ê²° ì¢…ë£Œ
dbDisconnect(con)</code></pre>
            </div>

            <hr>

            <h2>4. Python ì—°ë™</h2>

            <h3>4.1 sqlite3 ê¸°ë³¸ ì—°ê²°</h3>

            <div class="sql-box">
                <h3>â–¶ Python ì½”ë“œ: sqlite3 ê¸°ë³¸ ì‚¬ìš©</h3>
                <pre><code>import sqlite3
import pandas as pd

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
conn = sqlite3.connect('research.db')
cursor = conn.cursor()

# í…Œì´ë¸” ëª©ë¡ í™•ì¸
cursor.execute("SELECT name FROM sqlite_master WHERE type='table'")
print(cursor.fetchall())

# SQL ì¿¼ë¦¬ ì‹¤í–‰
cursor.execute("""
    SELECT participant_id, age, sex, group_id, vas_pre, vas_post
    FROM participants
    WHERE vas_pre IS NOT NULL
""")

# ê²°ê³¼ ê°€ì ¸ì˜¤ê¸°
rows = cursor.fetchall()
columns = [description[0] for description in cursor.description]

# í™•ì¸
for row in rows[:5]:
    print(row)

conn.close()</code></pre>
            </div>

            <h3>4.2 pandasë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</h3>

            <div class="sql-box">
                <h3>â–¶ Python ì½”ë“œ: pandas + SQLite</h3>
                <pre><code>import pandas as pd
import sqlite3

# ì—°ê²°
conn = sqlite3.connect('research.db')

# SQL ì¿¼ë¦¬ ê²°ê³¼ë¥¼ DataFrameìœ¼ë¡œ
df = pd.read_sql_query("""
    SELECT *
    FROM participants
    WHERE vas_pre IS NOT NULL
""", conn)

# ê¸°ë³¸ ì •ë³´ í™•ì¸
print(df.info())
print(df.describe())

# ì§‘ë‹¨ë³„ ê¸°ìˆ í†µê³„
print(df.groupby('group_id').agg({
    'age': ['mean', 'std'],
    'vas_pre': ['mean', 'std'],
    'vas_post': ['mean', 'std']
}))

conn.close()</code></pre>
            </div>

            <h3>4.3 SQLAlchemy í™œìš©</h3>

            <div class="concept-box">
                <h3>ğŸ“‹ SQLAlchemyë€?</h3>
                <p><strong>SQLAlchemy</strong>ëŠ” Pythonì˜ ê°•ë ¥í•œ ORM(Object-Relational Mapping) ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. ë‹¤ì–‘í•œ DB(SQLite, PostgreSQL, MySQL ë“±)ë¥¼ ë™ì¼í•œ ì½”ë“œë¡œ ë‹¤ë£° ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>

            <div class="sql-box">
                <h3>â–¶ Python ì½”ë“œ: SQLAlchemy ì‚¬ìš©</h3>
                <pre><code>from sqlalchemy import create_engine
import pandas as pd

# SQLite ì—”ì§„ ìƒì„±
engine = create_engine('sqlite:///research.db')

# pandasì™€ í•¨ê»˜ ì‚¬ìš©
df = pd.read_sql_query("""
    SELECT p.*, g.group_name
    FROM participants p
    LEFT JOIN groups g ON p.group_id = g.group_id
""", engine)

# ë¶„ì„ ê²°ê³¼ ì €ì¥
results_df = pd.DataFrame({
    'analysis_id': [1],
    'test_type': ['t-test'],
    'p_value': [0.023],
    'effect_size': [0.45]
})

# DataFrameì„ DB í…Œì´ë¸”ë¡œ ì €ì¥
results_df.to_sql('python_analysis_results', engine,
                  if_exists='append', index=False)

# í™•ì¸
pd.read_sql_query("SELECT * FROM python_analysis_results", engine)</code></pre>
            </div>

            <h3>4.4 ê°’ ë ˆì´ë¸”ì„ ì¹´í…Œê³ ë¦¬ë¡œ ë³€í™˜</h3>

            <div class="sql-box">
                <h3>â–¶ Python ì½”ë“œ: ì¹´í…Œê³ ë¦¬ íƒ€ì… ì ìš©</h3>
                <pre><code>import pandas as pd
import sqlite3

conn = sqlite3.connect('research.db')

# ë°ì´í„° ë¡œë“œ
df = pd.read_sql_query("SELECT * FROM participants", conn)

# ê°’ ë ˆì´ë¸” ë¡œë“œ
value_labels = pd.read_sql_query("""
    SELECT dd.variable_name, vl.code_value, vl.label
    FROM value_labels vl
    JOIN data_dictionary dd ON vl.variable_id = dd.variable_id
""", conn)

# sex ë³€ìˆ˜ì— ë ˆì´ë¸” ì ìš©
sex_map = value_labels[value_labels['variable_name'] == 'sex']
sex_dict = dict(zip(sex_map['code_value'].astype(int), sex_map['label']))
df['sex'] = df['sex'].map(sex_dict)

# group ë³€ìˆ˜ì— ë ˆì´ë¸” ì ìš©
group_map = value_labels[value_labels['variable_name'] == 'group']
group_dict = dict(zip(group_map['code_value'].astype(int), group_map['label']))
df['group_id'] = df['group_id'].map(group_dict)

# ì¹´í…Œê³ ë¦¬ íƒ€ì…ìœ¼ë¡œ ë³€í™˜
df['sex'] = df['sex'].astype('category')
df['group_id'] = df['group_id'].astype('category')

print(df.dtypes)
print(df['sex'].value_counts())

conn.close()</code></pre>
            </div>

            <hr>

            <h2>5. Excel ì—°ë™</h2>

            <h3>5.1 íŒŒì›Œ ì¿¼ë¦¬(Power Query)ë¡œ SQLite ì—°ê²°</h3>

            <div class="example-box">
                <h3>ğŸ’¡ Excel íŒŒì›Œ ì¿¼ë¦¬ ì—°ê²° ë‹¨ê³„</h3>
                <ol>
                    <li>ë°ì´í„° íƒ­ â†’ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° â†’ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ â†’ ODBCì—ì„œ</li>
                    <li>SQLite ODBC DSN ì„ íƒ</li>
                    <li>ì›í•˜ëŠ” í…Œì´ë¸” ì„ íƒ ë˜ëŠ” SQL ì¿¼ë¦¬ ì§ì ‘ ì…ë ¥</li>
                    <li>ë¡œë“œ ë˜ëŠ” ë°ì´í„° ë³€í™˜ ì„ íƒ</li>
                </ol>
                <p>íŒŒì›Œ ì¿¼ë¦¬ì˜ ì¥ì : ì›ë³¸ ë°ì´í„° ë³€ê²½ ì‹œ ìƒˆë¡œ ê³ ì¹¨ìœ¼ë¡œ ìë™ ì—…ë°ì´íŠ¸</p>
            </div>

            <h3>5.2 Excelì—ì„œ ì§ì ‘ CSV ê°€ì ¸ì˜¤ê¸°</h3>

            <div class="example-box">
                <h3>ğŸ’¡ Excelì—ì„œ UTF-8 CSV ì˜¬ë°”ë¥´ê²Œ ì—´ê¸°</h3>
                <ol>
                    <li>ìƒˆ Excel ì›Œí¬ë¶ ì—´ê¸°</li>
                    <li>ë°ì´í„° íƒ­ â†’ í…ìŠ¤íŠ¸/CSVì—ì„œ ê°€ì ¸ì˜¤ê¸°</li>
                    <li>íŒŒì¼ ì„ íƒ í›„ ì¸ì½”ë”©ì„ <strong>65001: ìœ ë‹ˆì½”ë“œ (UTF-8)</strong>ë¡œ ì„ íƒ</li>
                    <li>êµ¬ë¶„ ê¸°í˜¸ í™•ì¸ (ì‰¼í‘œ) í›„ ë¡œë“œ</li>
                </ol>
            </div>

            <h3>5.3 í”¼ë²— í…Œì´ë¸”ë¡œ ìš”ì•½ ë¶„ì„</h3>

            <div class="example-box">
                <h3>ğŸ’¡ í”¼ë²— í…Œì´ë¸” í™œìš©</h3>
                <p>ë°ì´í„°ë¥¼ Excelë¡œ ê°€ì ¸ì˜¨ í›„:</p>
                <ol>
                    <li>ë°ì´í„° ë²”ìœ„ ì„ íƒ â†’ ì‚½ì… â†’ í”¼ë²— í…Œì´ë¸”</li>
                    <li>í–‰: group_id (ì§‘ë‹¨)</li>
                    <li>ê°’: vas_pre, vas_postì˜ í‰ê· </li>
                    <li>í•„í„°: sex (ì„±ë³„)</li>
                </ol>
                <p>SQLì˜ GROUP BYì™€ ìœ ì‚¬í•œ ì§‘ê³„ ë¶„ì„ì„ ì‹œê°ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>

            <h3>5.4 Excel ë°ì´í„°ë¥¼ DBë¡œ ê°€ì ¸ì˜¤ê¸°</h3>

            <div class="sql-box">
                <h3>â–¶ Pythonìœ¼ë¡œ Excel â†’ SQLite</h3>
                <pre><code>import pandas as pd
import sqlite3

# Excel íŒŒì¼ ì½ê¸°
df_new = pd.read_excel('new_participants.xlsx', sheet_name='Sheet1')

# ë°ì´í„° ê²€ì¦
print(df_new.info())
print(df_new.head())

# SQLiteì— ì €ì¥
conn = sqlite3.connect('research.db')

# ê¸°ì¡´ í…Œì´ë¸”ì— ì¶”ê°€ (append)
df_new.to_sql('participants', conn, if_exists='append', index=False)

# ë˜ëŠ” ìƒˆ í…Œì´ë¸”ë¡œ ì €ì¥
# df_new.to_sql('participants_wave2', conn, if_exists='replace', index=False)

print(f"ì €ì¥ ì™„ë£Œ: {len(df_new)}ê±´")
conn.close()</code></pre>
            </div>

            <hr>

            <h2>6. ë¶„ì„ ì›Œí¬í”Œë¡œìš° ì„¤ê³„</h2>

            <h3>6.1 DB ì¤‘ì‹¬ ë¶„ì„ ì›Œí¬í”Œë¡œìš°</h3>

            <div class="concept-box">
                <h3>ğŸ”„ ë°ì´í„° ë¶„ì„ ì‚¬ì´í´</h3>
                <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì›ë³¸ ë°ì´í„°  â”‚ â†’  â”‚  SQLite DB   â”‚ â†’  â”‚  ë¶„ì„ ë„êµ¬   â”‚
â”‚  (Excel/CSV) â”‚    â”‚  (ì €ì¥/ê´€ë¦¬)  â”‚    â”‚  (R/Python) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“                   â†“
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  ì½”ë“œë¶/     â”‚ â†  â”‚  ë¶„ì„ ê²°ê³¼   â”‚
                   â”‚  ë©”íƒ€ë°ì´í„°  â”‚    â”‚  (DB ì €ì¥)   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </pre>
            </div>

            <h3>6.2 ìë™í™” ìŠ¤í¬ë¦½íŠ¸ ì˜ˆì‹œ</h3>

            <div class="sql-box">
                <h3>â–¶ Python: ë¶„ì„ íŒŒì´í”„ë¼ì¸ ìë™í™”</h3>
                <pre><code>"""
ì—°êµ¬ ë°ì´í„° ë¶„ì„ ìë™í™” ìŠ¤í¬ë¦½íŠ¸
balance_analysis.py
"""

import sqlite3
import pandas as pd
from scipy import stats
from datetime import datetime

def connect_db(db_path='research.db'):
    """ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°"""
    return sqlite3.connect(db_path)

def load_data(conn, query=None):
    """ë¶„ì„ìš© ë°ì´í„° ë¡œë“œ"""
    if query is None:
        query = """
            SELECT * FROM participants
            WHERE vas_pre IS NOT NULL AND vas_post IS NOT NULL
        """
    return pd.read_sql_query(query, conn)

def run_descriptive(df, group_var, outcome_vars):
    """ì§‘ë‹¨ë³„ ê¸°ìˆ í†µê³„"""
    results = df.groupby(group_var)[outcome_vars].agg(['count', 'mean', 'std'])
    return results

def run_ttest(df, group_var, outcome_var, group1, group2):
    """ë…ë¦½í‘œë³¸ t-ê²€ì •"""
    g1 = df[df[group_var] == group1][outcome_var].dropna()
    g2 = df[df[group_var] == group2][outcome_var].dropna()
    stat, pval = stats.ttest_ind(g1, g2)
    return {'t_statistic': stat, 'p_value': pval,
            'mean_g1': g1.mean(), 'mean_g2': g2.mean()}

def save_results(conn, results_df, table_name):
    """ë¶„ì„ ê²°ê³¼ DBì— ì €ì¥"""
    results_df['analysis_date'] = datetime.now()
    results_df.to_sql(table_name, conn, if_exists='append', index=False)

def main():
    # ì—°ê²°
    conn = connect_db()

    # ë°ì´í„° ë¡œë“œ
    df = load_data(conn)
    print(f"ë¶„ì„ ëŒ€ìƒ: {len(df)}ëª…")

    # ê¸°ìˆ í†µê³„
    desc = run_descriptive(df, 'group_id', ['vas_pre', 'vas_post', 'berg_pre', 'berg_post'])
    print("\n=== ê¸°ìˆ í†µê³„ ===")
    print(desc)

    # t-ê²€ì • (ì‹¤í—˜êµ°A vs ëŒ€ì¡°êµ°)
    ttest = run_ttest(df, 'group_id', 'vas_post', 1, 3)
    print(f"\n=== t-ê²€ì • (VAS ì‚¬í›„: ì‹¤í—˜êµ°A vs ëŒ€ì¡°êµ°) ===")
    print(f"t = {ttest['t_statistic']:.3f}, p = {ttest['p_value']:.4f}")

    # ê²°ê³¼ ì €ì¥
    results = pd.DataFrame([{
        'analysis_type': 'ttest_vas_post',
        'comparison': 'group1_vs_group3',
        't_value': ttest['t_statistic'],
        'p_value': ttest['p_value']
    }])
    save_results(conn, results, 'automated_results')

    conn.close()
    print("\në¶„ì„ ì™„ë£Œ!")

if __name__ == "__main__":
    main()</code></pre>
            </div>

            <h3>6.3 ë²„ì „ ê´€ë¦¬ì™€ ë°±ì—…</h3>

            <div class="warning-box">
                <h3>âš ï¸ ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ì›ì¹™</h3>
                <ul>
                    <li><strong>ì •ê¸° ë°±ì—…</strong>: ì£¼ìš” ë¶„ì„ ì „í›„ DB íŒŒì¼ ë³µì‚¬</li>
                    <li><strong>ë²„ì „ëª… í¬í•¨</strong>: research_v1.0_2024-03-15.db</li>
                    <li><strong>ë¶„ì„ ì½”ë“œ</strong>: Gitìœ¼ë¡œ ë²„ì „ ê´€ë¦¬</li>
                    <li><strong>ê²°ê³¼ ì¬í˜„</strong>: ì½”ë“œ + ë°ì´í„° ë²„ì „ ë§¤ì¹­ ê¸°ë¡</li>
                </ul>
            </div>

            <div class="sql-box">
                <h3>â–¶ ë°±ì—… ìë™í™” ìŠ¤í¬ë¦½íŠ¸ (Python)</h3>
                <pre><code>import shutil
from datetime import datetime
import os

def backup_database(db_path, backup_dir='backups'):
    """ë°ì´í„°ë² ì´ìŠ¤ ìë™ ë°±ì—…"""

    # ë°±ì—… ë””ë ‰í† ë¦¬ ìƒì„±
    os.makedirs(backup_dir, exist_ok=True)

    # ë°±ì—… íŒŒì¼ëª… ìƒì„±
    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
    db_name = os.path.basename(db_path).replace('.db', '')
    backup_name = f"{db_name}_{timestamp}.db"
    backup_path = os.path.join(backup_dir, backup_name)

    # ë³µì‚¬
    shutil.copy2(db_path, backup_path)
    print(f"ë°±ì—… ì™„ë£Œ: {backup_path}")

    return backup_path

# ì‚¬ìš©
backup_database('research.db')</code></pre>
            </div>

            <h3>6.4 ìµœì¢… í†µí•© ì—°êµ¬ DB êµ¬ì¡°</h3>

            <div class="sql-box">
                <h3>â–¶ ì™„ì „í•œ ì—°êµ¬ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ</h3>
                <pre><code>-- =============================================
-- ì—°êµ¬ ë°ì´í„°ë² ì´ìŠ¤ í†µí•© ìŠ¤í‚¤ë§ˆ
-- ë¬¼ë¦¬ì¹˜ë£Œ ì—°êµ¬ë¥¼ ìœ„í•œ ì™„ì „í•œ DB êµ¬ì¡°
-- =============================================

-- 1. ë©”íƒ€ë°ì´í„° ì˜ì—­
-- studies: ì—°êµ¬ í”„ë¡œì íŠ¸ ì •ë³´
-- datasets: ë°ì´í„°ì…‹ ì •ë³´
-- data_dictionary: ë³€ìˆ˜ ì‚¬ì „
-- value_labels: ê°’ ë ˆì´ë¸”
-- dataset_versions: ë²„ì „ ê´€ë¦¬

-- 2. ì—°êµ¬ ëŒ€ìƒ ì˜ì—­
-- participants: ì—°êµ¬ ëŒ€ìƒì
-- groups: ì‹¤í—˜/ëŒ€ì¡°êµ° ì •ì˜
-- assessors: í‰ê°€ì ì •ë³´

-- 3. ì¸¡ì • ë°ì´í„° ì˜ì—­
-- measurements: ì¸¡ì • ê²°ê³¼ (EAV êµ¬ì¡°)
-- sessions: ì¸¡ì • ì„¸ì…˜/ì‹œì 
-- instruments: ì¸¡ì • ë„êµ¬ ì •ë³´

-- 4. ì„¤ë¬¸ ë°ì´í„° ì˜ì—­
-- surveys: ì„¤ë¬¸ì§€ ì •ì˜
-- questions: ë¬¸í•­
-- responses: ì‘ë‹µ

-- 5. ë¶„ì„ ê²°ê³¼ ì˜ì—­
-- analysis_results: í†µê³„ ë¶„ì„ ê²°ê³¼
-- descriptive_stats: ê¸°ìˆ í†µê³„
-- regression_models: íšŒê·€ ëª¨ë¸

-- í…Œì´ë¸” ê´€ê³„ ìš”ì•½
/*
studies (1) â”€â”¬â”€ (N) datasets (1) â”€â”€â”€ (N) data_dictionary
             â”‚                              â”‚
             â”‚                              â””â”€â”€ (N) value_labels
             â”‚
             â””â”€ (N) participants (1) â”€â”¬â”€ (N) measurements
                                      â”‚
                                      â””â”€ (N) survey_responses
*/

-- DB ì •ë³´ í™•ì¸ ì¿¼ë¦¬
SELECT
    'tables' AS category,
    COUNT(*) AS count
FROM sqlite_master
WHERE type = 'table'

UNION ALL

SELECT
    'views' AS category,
    COUNT(*) AS count
FROM sqlite_master
WHERE type = 'view'

UNION ALL

SELECT
    'triggers' AS category,
    COUNT(*) AS count
FROM sqlite_master
WHERE type = 'trigger';</code></pre>
            </div>

            <div class="summary-box">
                <h3>ğŸ“ ì´ ì¥ì˜ í•µì‹¬ ì •ë¦¬</h3>
                <ul>
                    <li><strong>CSV</strong>ëŠ” ë²”ìš© êµí™˜ í˜•ì‹ì´ì§€ë§Œ ë©”íƒ€ë°ì´í„°ë¥¼ í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</li>
                    <li><strong>SPSS</strong>: ODBC ì—°ê²° ë˜ëŠ” CSV ê°€ì ¸ì˜¤ê¸° í›„ êµ¬ë¬¸ìœ¼ë¡œ ë ˆì´ë¸” ì •ì˜</li>
                    <li><strong>R</strong>: DBI/RSQLite íŒ¨í‚¤ì§€ë¡œ ì§ì ‘ ì—°ê²°, dplyrë¡œ tidyverse ìŠ¤íƒ€ì¼ ì¿¼ë¦¬ ê°€ëŠ¥</li>
                    <li><strong>Python</strong>: sqlite3 ë˜ëŠ” SQLAlchemy + pandasë¡œ ìœ ì—°í•œ ë°ì´í„° ì²˜ë¦¬</li>
                    <li><strong>Excel</strong>: íŒŒì›Œ ì¿¼ë¦¬ë¡œ ODBC ì—°ê²°, í”¼ë²— í…Œì´ë¸”ë¡œ ìš”ì•½ ë¶„ì„</li>
                    <li><strong>ë¶„ì„ ì›Œí¬í”Œë¡œìš°</strong>: DB ì¤‘ì‹¬ ì €ì¥ â†’ ë¶„ì„ ë„êµ¬ ì—°ê²° â†’ ê²°ê³¼ DB ì €ì¥</li>
                    <li><strong>ìë™í™”</strong>: Python/R ìŠ¤í¬ë¦½íŠ¸ë¡œ ë°˜ë³µ ì‘ì—… ìë™í™”</li>
                    <li><strong>ë°±ì—…</strong>: ë¶„ì„ ì „í›„ ì •ê¸°ì  ë°±ì—…ê³¼ ë²„ì „ ê´€ë¦¬ í•„ìˆ˜</li>
                </ul>
            </div>

            <div class="final-box">
                <h3>ğŸ“ 6ê¶Œì„ ë§ˆì¹˜ë©°</h3>
                <p>ì¶•í•˜í•©ë‹ˆë‹¤! <strong>ì—°êµ¬ ë°ì´í„° ì„¤ê³„</strong>ì˜ ê¸°ì´ˆë¶€í„° ê³ ê¸‰ í†µê³„ ë¶„ì„ì„ ìœ„í•œ DB êµ¬ì¡°ê¹Œì§€ ëª¨ë‘ í•™ìŠµí–ˆìŠµë‹ˆë‹¤.</p>

                <h4>6ê¶Œì—ì„œ ë°°ìš´ ë‚´ìš©:</h4>
                <ul>
                    <li><strong>1ë¶€</strong>: ë³€ìˆ˜ì˜ ì¢…ë¥˜ì™€ ì¸¡ì • ì²™ë„ (ëª…ëª©, ì„œì—´, ë“±ê°„, ë¹„ìœ¨)</li>
                    <li><strong>2ë¶€</strong>: ë‹¤ì–‘í•œ ì—°êµ¬ ì„¤ê³„ (íš¡ë‹¨, ì¢…ë‹¨, RCT, ì½”í˜¸íŠ¸ ë“±)ì— ë§ëŠ” DB êµ¬ì¡°</li>
                    <li><strong>3ë¶€</strong>: ì„ìƒ ì¸¡ì •, ì„¤ë¬¸, ì§ˆì  ì—°êµ¬ ë°ì´í„°ì˜ ì²´ê³„ì  ì €ì¥</li>
                    <li><strong>4ë¶€</strong>: ê¸°ìˆ í†µê³„, t-test, ANOVA, ìƒê´€, íšŒê·€ë¶„ì„ ê²°ê³¼ë¥¼ ìœ„í•œ í…Œì´ë¸” ì„¤ê³„</li>
                    <li><strong>5ë¶€</strong>: ì½”ë“œë¶, ë©”íƒ€ë°ì´í„°, ë¶„ì„ ë„êµ¬ ì—°ë™</li>
                </ul>

                <h4>ë‹¤ìŒ ë‹¨ê³„:</h4>
                <ul>
                    <li>ì§ì ‘ ì—°êµ¬ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì„¤ê³„í•˜ê³  êµ¬ì¶•í•´ë³´ì„¸ìš”</li>
                    <li>ì‹¤ì œ ì—°êµ¬ ë°ì´í„°ë¡œ ì „ì²´ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤ìŠµí•˜ì„¸ìš”</li>
                    <li>ì½”ë“œë¶ì„ ì‘ì„±í•˜ê³  ë°ì´í„°ë¥¼ ë¬¸ì„œí™”í•˜ì„¸ìš”</li>
                    <li>R ë˜ëŠ” Pythonìœ¼ë¡œ ë¶„ì„ ìë™í™”ë¥¼ ì‹œë„í•´ë³´ì„¸ìš”</li>
                </ul>

                <p style="margin-top: 1.5rem; font-size: 1.1rem;"><strong>ì˜ ì„¤ê³„ëœ ì—°êµ¬ ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì¬í˜„ ê°€ëŠ¥í•œ ì—°êµ¬ì˜ ì‹œì‘ì…ë‹ˆë‹¤.</strong></p>
            </div>

            <div class="nav-buttons">
                <a href="chapter-19.html" class="nav-btn">â† ì´ì „</a>
                <span class="page-num">20 / 20</span>
                <a href="../index.html" class="nav-btn">ëª©ì°¨ë¡œ â†’</a>
            </div>
        </main>
    </div>
    <script src="../js/nav.js"></script>
</body>
</html>
